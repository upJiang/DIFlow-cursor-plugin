(()=>{var e={3873:(e,t,r)=>{"use strict";const s=r(77),o=r(1017),n=r(1381).mkdirsSync,i=r(318).utimesMillisSync,c=r(2733);function a(e,t,r,n){const i=(n.dereference?s.statSync:s.lstatSync)(t);if(i.isDirectory())return function(e,t,r,o,n){return t?d(r,o,n):function(e,t,r,o){return s.mkdirSync(r),d(t,r,o),u(r,e)}(e.mode,r,o,n)}(i,e,t,r,n);if(i.isFile()||i.isCharacterDevice()||i.isBlockDevice())return function(e,t,r,o,n){return t?function(e,t,r,o){if(o.overwrite)return s.unlinkSync(r),l(e,t,r,o);if(o.errorOnExist)throw new Error(`'${r}' already exists`)}(e,r,o,n):l(e,r,o,n)}(i,e,t,r,n);if(i.isSymbolicLink())return function(e,t,r,n){let i=s.readlinkSync(t);if(n.dereference&&(i=o.resolve(process.cwd(),i)),e){let e;try{e=s.readlinkSync(r)}catch(e){if("EINVAL"===e.code||"UNKNOWN"===e.code)return s.symlinkSync(i,r);throw e}if(n.dereference&&(e=o.resolve(process.cwd(),e)),c.isSrcSubdir(i,e))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${e}'.`);if(c.isSrcSubdir(e,i))throw new Error(`Cannot overwrite '${e}' with '${i}'.`);return function(e,t){return s.unlinkSync(t),s.symlinkSync(e,t)}(i,r)}return s.symlinkSync(i,r)}(e,t,r,n);if(i.isSocket())throw new Error(`Cannot copy a socket file: ${t}`);if(i.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${t}`);throw new Error(`Unknown file: ${t}`)}function l(e,t,r,o){return s.copyFileSync(t,r),o.preserveTimestamps&&function(e,t,r){(function(e){return 0==(128&e)})(e)&&function(e,t){u(e,128|t)}(r,e),function(e,t){const r=s.statSync(e);i(t,r.atime,r.mtime)}(t,r)}(e.mode,t,r),u(r,e.mode)}function u(e,t){return s.chmodSync(e,t)}function d(e,t,r){s.readdirSync(e).forEach((s=>function(e,t,r,s){const n=o.join(t,e),i=o.join(r,e);if(s.filter&&!s.filter(n,i))return;const{destStat:l}=c.checkPathsSync(n,i,"copy",s);return a(l,n,i,s)}(s,e,t,r)))}e.exports=function(e,t,r){"function"==typeof r&&(r={filter:r}),(r=r||{}).clobber=!("clobber"in r)||!!r.clobber,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&"ia32"===process.arch&&process.emitWarning("Using the preserveTimestamps option in 32-bit node is not recommended;\n\n\tsee https://github.com/jprichardson/node-fs-extra/issues/269","Warning","fs-extra-WARN0002");const{srcStat:i,destStat:l}=c.checkPathsSync(e,t,"copy",r);if(c.checkParentPathsSync(e,i,t,"copy"),r.filter&&!r.filter(e,t))return;const u=o.dirname(t);return s.existsSync(u)||n(u),a(l,e,t,r)}},7189:(e,t,r)=>{"use strict";const s=r(7749),o=r(1017),{mkdirs:n}=r(1381),{pathExists:i}=r(9257),{utimesMillis:c}=r(318),a=r(2733);async function l(e,t,r){return!r.filter||r.filter(e,t)}async function u(e,t,r,n){const i=n.dereference?s.stat:s.lstat,c=await i(t);if(c.isDirectory())return async function(e,t,r,n,i){t||await s.mkdir(n);const c=await s.readdir(r);await Promise.all(c.map((async e=>{const t=o.join(r,e),s=o.join(n,e);if(!await l(t,s,i))return;const{destStat:c}=await a.checkPaths(t,s,"copy",i);return u(c,t,s,i)}))),t||await s.chmod(n,e.mode)}(c,e,t,r,n);if(c.isFile()||c.isCharacterDevice()||c.isBlockDevice())return async function(e,t,r,o,n){if(!t)return d(e,r,o,n);if(n.overwrite)return await s.unlink(o),d(e,r,o,n);if(n.errorOnExist)throw new Error(`'${o}' already exists`)}(c,e,t,r,n);if(c.isSymbolicLink())return async function(e,t,r,n){let i=await s.readlink(t);if(n.dereference&&(i=o.resolve(process.cwd(),i)),!e)return s.symlink(i,r);let c=null;try{c=await s.readlink(r)}catch(e){if("EINVAL"===e.code||"UNKNOWN"===e.code)return s.symlink(i,r);throw e}if(n.dereference&&(c=o.resolve(process.cwd(),c)),a.isSrcSubdir(i,c))throw new Error(`Cannot copy '${i}' to a subdirectory of itself, '${c}'.`);if(a.isSrcSubdir(c,i))throw new Error(`Cannot overwrite '${c}' with '${i}'.`);return await s.unlink(r),s.symlink(i,r)}(e,t,r,n);if(c.isSocket())throw new Error(`Cannot copy a socket file: ${t}`);if(c.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${t}`);throw new Error(`Unknown file: ${t}`)}async function d(e,t,r,o){if(await s.copyFile(t,r),o.preserveTimestamps){0==(128&e.mode)&&await function(e,t){return s.chmod(e,128|t)}(r,e.mode);const o=await s.stat(t);await c(r,o.atime,o.mtime)}return s.chmod(r,e.mode)}e.exports=async function(e,t,r={}){"function"==typeof r&&(r={filter:r}),r.clobber=!("clobber"in r)||!!r.clobber,r.overwrite="overwrite"in r?!!r.overwrite:r.clobber,r.preserveTimestamps&&"ia32"===process.arch&&process.emitWarning("Using the preserveTimestamps option in 32-bit node is not recommended;\n\n\tsee https://github.com/jprichardson/node-fs-extra/issues/269","Warning","fs-extra-WARN0001");const{srcStat:s,destStat:c}=await a.checkPaths(e,t,"copy",r);if(await a.checkParentPaths(e,s,t,"copy"),!await l(e,t,r))return;const d=o.dirname(t);await i(d)||await n(d),await u(c,e,t,r)}},6464:(e,t,r)=>{"use strict";const s=r(8981).fromPromise;e.exports={copy:s(r(7189)),copySync:r(3873)}},5590:(e,t,r)=>{"use strict";const s=r(8981).fromPromise,o=r(7749),n=r(1017),i=r(1381),c=r(4542),a=s((async function(e){let t;try{t=await o.readdir(e)}catch{return i.mkdirs(e)}return Promise.all(t.map((t=>c.remove(n.join(e,t)))))}));function l(e){let t;try{t=o.readdirSync(e)}catch{return i.mkdirsSync(e)}t.forEach((t=>{t=n.join(e,t),c.removeSync(t)}))}e.exports={emptyDirSync:l,emptydirSync:l,emptyDir:a,emptydir:a}},6530:(e,t,r)=>{"use strict";const s=r(8981).fromPromise,o=r(1017),n=r(7749),i=r(1381);e.exports={createFile:s((async function(e){let t;try{t=await n.stat(e)}catch{}if(t&&t.isFile())return;const r=o.dirname(e);let s=null;try{s=await n.stat(r)}catch(t){if("ENOENT"===t.code)return await i.mkdirs(r),void await n.writeFile(e,"");throw t}s.isDirectory()?await n.writeFile(e,""):await n.readdir(r)})),createFileSync:function(e){let t;try{t=n.statSync(e)}catch{}if(t&&t.isFile())return;const r=o.dirname(e);try{n.statSync(r).isDirectory()||n.readdirSync(r)}catch(e){if(!e||"ENOENT"!==e.code)throw e;i.mkdirsSync(r)}n.writeFileSync(e,"")}}},1720:(e,t,r)=>{"use strict";const{createFile:s,createFileSync:o}=r(6530),{createLink:n,createLinkSync:i}=r(4147),{createSymlink:c,createSymlinkSync:a}=r(3635);e.exports={createFile:s,createFileSync:o,ensureFile:s,ensureFileSync:o,createLink:n,createLinkSync:i,ensureLink:n,ensureLinkSync:i,createSymlink:c,createSymlinkSync:a,ensureSymlink:c,ensureSymlinkSync:a}},4147:(e,t,r)=>{"use strict";const s=r(8981).fromPromise,o=r(1017),n=r(7749),i=r(1381),{pathExists:c}=r(9257),{areIdentical:a}=r(2733);e.exports={createLink:s((async function(e,t){let r,s;try{r=await n.lstat(t)}catch{}try{s=await n.lstat(e)}catch(e){throw e.message=e.message.replace("lstat","ensureLink"),e}if(r&&a(s,r))return;const l=o.dirname(t);await c(l)||await i.mkdirs(l),await n.link(e,t)})),createLinkSync:function(e,t){let r;try{r=n.lstatSync(t)}catch{}try{const t=n.lstatSync(e);if(r&&a(t,r))return}catch(e){throw e.message=e.message.replace("lstat","ensureLink"),e}const s=o.dirname(t);return n.existsSync(s)||i.mkdirsSync(s),n.linkSync(e,t)}}},6072:(e,t,r)=>{"use strict";const s=r(1017),o=r(7749),{pathExists:n}=r(9257),i=r(8981).fromPromise;e.exports={symlinkPaths:i((async function(e,t){if(s.isAbsolute(e)){try{await o.lstat(e)}catch(e){throw e.message=e.message.replace("lstat","ensureSymlink"),e}return{toCwd:e,toDst:e}}const r=s.dirname(t),i=s.join(r,e);if(await n(i))return{toCwd:i,toDst:e};try{await o.lstat(e)}catch(e){throw e.message=e.message.replace("lstat","ensureSymlink"),e}return{toCwd:e,toDst:s.relative(r,e)}})),symlinkPathsSync:function(e,t){if(s.isAbsolute(e)){if(!o.existsSync(e))throw new Error("absolute srcpath does not exist");return{toCwd:e,toDst:e}}const r=s.dirname(t),n=s.join(r,e);if(o.existsSync(n))return{toCwd:n,toDst:e};if(!o.existsSync(e))throw new Error("relative srcpath does not exist");return{toCwd:e,toDst:s.relative(r,e)}}}},9259:(e,t,r)=>{"use strict";const s=r(7749),o=r(8981).fromPromise;e.exports={symlinkType:o((async function(e,t){if(t)return t;let r;try{r=await s.lstat(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"})),symlinkTypeSync:function(e,t){if(t)return t;let r;try{r=s.lstatSync(e)}catch{return"file"}return r&&r.isDirectory()?"dir":"file"}}},3635:(e,t,r)=>{"use strict";const s=r(8981).fromPromise,o=r(1017),n=r(7749),{mkdirs:i,mkdirsSync:c}=r(1381),{symlinkPaths:a,symlinkPathsSync:l}=r(6072),{symlinkType:u,symlinkTypeSync:d}=r(9259),{pathExists:f}=r(9257),{areIdentical:h}=r(2733);e.exports={createSymlink:s((async function(e,t,r){let s;try{s=await n.lstat(t)}catch{}if(s&&s.isSymbolicLink()){const[r,s]=await Promise.all([n.stat(e),n.stat(t)]);if(h(r,s))return}const c=await a(e,t);e=c.toDst;const l=await u(c.toCwd,r),d=o.dirname(t);return await f(d)||await i(d),n.symlink(e,t,l)})),createSymlinkSync:function(e,t,r){let s;try{s=n.lstatSync(t)}catch{}if(s&&s.isSymbolicLink()){const r=n.statSync(e),s=n.statSync(t);if(h(r,s))return}const i=l(e,t);e=i.toDst,r=d(i.toCwd,r);const a=o.dirname(t);return n.existsSync(a)||c(a),n.symlinkSync(e,t,r)}}},7749:(e,t,r)=>{"use strict";const s=r(8981).fromCallback,o=r(77),n=["access","appendFile","chmod","chown","close","copyFile","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","lchmod","lchown","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","symlink","truncate","unlink","utimes","writeFile"].filter((e=>"function"==typeof o[e]));Object.assign(t,o),n.forEach((e=>{t[e]=s(o[e])})),t.exists=function(e,t){return"function"==typeof t?o.exists(e,t):new Promise((t=>o.exists(e,t)))},t.read=function(e,t,r,s,n,i){return"function"==typeof i?o.read(e,t,r,s,n,i):new Promise(((i,c)=>{o.read(e,t,r,s,n,((e,t,r)=>{if(e)return c(e);i({bytesRead:t,buffer:r})}))}))},t.write=function(e,t,...r){return"function"==typeof r[r.length-1]?o.write(e,t,...r):new Promise(((s,n)=>{o.write(e,t,...r,((e,t,r)=>{if(e)return n(e);s({bytesWritten:t,buffer:r})}))}))},t.readv=function(e,t,...r){return"function"==typeof r[r.length-1]?o.readv(e,t,...r):new Promise(((s,n)=>{o.readv(e,t,...r,((e,t,r)=>{if(e)return n(e);s({bytesRead:t,buffers:r})}))}))},t.writev=function(e,t,...r){return"function"==typeof r[r.length-1]?o.writev(e,t,...r):new Promise(((s,n)=>{o.writev(e,t,...r,((e,t,r)=>{if(e)return n(e);s({bytesWritten:t,buffers:r})}))}))},"function"==typeof o.realpath.native?t.realpath.native=s(o.realpath.native):process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")},5674:(e,t,r)=>{"use strict";e.exports={...r(7749),...r(6464),...r(5590),...r(1720),...r(6573),...r(1381),...r(530),...r(4670),...r(9257),...r(4542)}},6573:(e,t,r)=>{"use strict";const s=r(8981).fromPromise,o=r(7183);o.outputJson=s(r(3508)),o.outputJsonSync=r(9578),o.outputJSON=o.outputJson,o.outputJSONSync=o.outputJsonSync,o.writeJSON=o.writeJson,o.writeJSONSync=o.writeJsonSync,o.readJSON=o.readJson,o.readJSONSync=o.readJsonSync,e.exports=o},7183:(e,t,r)=>{"use strict";const s=r(6813);e.exports={readJson:s.readFile,readJsonSync:s.readFileSync,writeJson:s.writeFile,writeJsonSync:s.writeFileSync}},9578:(e,t,r)=>{"use strict";const{stringify:s}=r(6780),{outputFileSync:o}=r(4670);e.exports=function(e,t,r){const n=s(t,r);o(e,n,r)}},3508:(e,t,r)=>{"use strict";const{stringify:s}=r(6780),{outputFile:o}=r(4670);e.exports=async function(e,t,r={}){const n=s(t,r);await o(e,n,r)}},1381:(e,t,r)=>{"use strict";const s=r(8981).fromPromise,{makeDir:o,makeDirSync:n}=r(8233),i=s(o);e.exports={mkdirs:i,mkdirsSync:n,mkdirp:i,mkdirpSync:n,ensureDir:i,ensureDirSync:n}},8233:(e,t,r)=>{"use strict";const s=r(7749),{checkPath:o}=r(3468),n=e=>"number"==typeof e?e:{mode:511,...e}.mode;e.exports.makeDir=async(e,t)=>(o(e),s.mkdir(e,{mode:n(t),recursive:!0})),e.exports.makeDirSync=(e,t)=>(o(e),s.mkdirSync(e,{mode:n(t),recursive:!0}))},3468:(e,t,r)=>{"use strict";const s=r(1017);e.exports.checkPath=function(e){if("win32"===process.platform&&/[<>:"|?*]/.test(e.replace(s.parse(e).root,""))){const t=new Error(`Path contains invalid characters: ${e}`);throw t.code="EINVAL",t}}},530:(e,t,r)=>{"use strict";const s=r(8981).fromPromise;e.exports={move:s(r(436)),moveSync:r(3736)}},3736:(e,t,r)=>{"use strict";const s=r(77),o=r(1017),n=r(6464).copySync,i=r(4542).removeSync,c=r(1381).mkdirpSync,a=r(2733);function l(e,t,r){try{s.renameSync(e,t)}catch(s){if("EXDEV"!==s.code)throw s;return function(e,t,r){return n(e,t,{overwrite:r,errorOnExist:!0,preserveTimestamps:!0}),i(e)}(e,t,r)}}e.exports=function(e,t,r){const n=(r=r||{}).overwrite||r.clobber||!1,{srcStat:u,isChangingCase:d=!1}=a.checkPathsSync(e,t,"move",r);return a.checkParentPathsSync(e,u,t,"move"),function(e){const t=o.dirname(e);return o.parse(t).root===t}(t)||c(o.dirname(t)),function(e,t,r,o){if(o)return l(e,t,r);if(r)return i(t),l(e,t,r);if(s.existsSync(t))throw new Error("dest already exists.");return l(e,t,r)}(e,t,n,d)}},436:(e,t,r)=>{"use strict";const s=r(7749),o=r(1017),{copy:n}=r(6464),{remove:i}=r(4542),{mkdirp:c}=r(1381),{pathExists:a}=r(9257),l=r(2733);e.exports=async function(e,t,r={}){const u=r.overwrite||r.clobber||!1,{srcStat:d,isChangingCase:f=!1}=await l.checkPaths(e,t,"move",r);await l.checkParentPaths(e,d,t,"move");const h=o.dirname(t);return o.parse(h).root!==h&&await c(h),async function(e,t,r,o){if(!o)if(r)await i(t);else if(await a(t))throw new Error("dest already exists.");try{await s.rename(e,t)}catch(s){if("EXDEV"!==s.code)throw s;await async function(e,t,r){const s={overwrite:r,errorOnExist:!0,preserveTimestamps:!0};return await n(e,t,s),i(e)}(e,t,r)}}(e,t,u,f)}},4670:(e,t,r)=>{"use strict";const s=r(8981).fromPromise,o=r(7749),n=r(1017),i=r(1381),c=r(9257).pathExists;e.exports={outputFile:s((async function(e,t,r="utf-8"){const s=n.dirname(e);return await c(s)||await i.mkdirs(s),o.writeFile(e,t,r)})),outputFileSync:function(e,...t){const r=n.dirname(e);o.existsSync(r)||i.mkdirsSync(r),o.writeFileSync(e,...t)}}},9257:(e,t,r)=>{"use strict";const s=r(8981).fromPromise,o=r(7749);e.exports={pathExists:s((function(e){return o.access(e).then((()=>!0)).catch((()=>!1))})),pathExistsSync:o.existsSync}},4542:(e,t,r)=>{"use strict";const s=r(77),o=r(8981).fromCallback;e.exports={remove:o((function(e,t){s.rm(e,{recursive:!0,force:!0},t)})),removeSync:function(e){s.rmSync(e,{recursive:!0,force:!0})}}},2733:(e,t,r)=>{"use strict";const s=r(7749),o=r(1017),n=r(8981).fromPromise;function i(e,t){return t.ino&&t.dev&&t.ino===e.ino&&t.dev===e.dev}function c(e,t){const r=o.resolve(e).split(o.sep).filter((e=>e)),s=o.resolve(t).split(o.sep).filter((e=>e));return r.every(((e,t)=>s[t]===e))}function a(e,t,r){return`Cannot ${r} '${e}' to a subdirectory of itself, '${t}'.`}e.exports={checkPaths:n((async function(e,t,r,n){const{srcStat:l,destStat:u}=await function(e,t,r){const o=r.dereference?e=>s.stat(e,{bigint:!0}):e=>s.lstat(e,{bigint:!0});return Promise.all([o(e),o(t).catch((e=>{if("ENOENT"===e.code)return null;throw e}))]).then((([e,t])=>({srcStat:e,destStat:t})))}(e,t,n);if(u){if(i(l,u)){const s=o.basename(e),n=o.basename(t);if("move"===r&&s!==n&&s.toLowerCase()===n.toLowerCase())return{srcStat:l,destStat:u,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(l.isDirectory()&&!u.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!l.isDirectory()&&u.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(l.isDirectory()&&c(e,t))throw new Error(a(e,t,r));return{srcStat:l,destStat:u}})),checkPathsSync:function(e,t,r,n){const{srcStat:l,destStat:u}=function(e,t,r){let o;const n=r.dereference?e=>s.statSync(e,{bigint:!0}):e=>s.lstatSync(e,{bigint:!0}),i=n(e);try{o=n(t)}catch(e){if("ENOENT"===e.code)return{srcStat:i,destStat:null};throw e}return{srcStat:i,destStat:o}}(e,t,n);if(u){if(i(l,u)){const s=o.basename(e),n=o.basename(t);if("move"===r&&s!==n&&s.toLowerCase()===n.toLowerCase())return{srcStat:l,destStat:u,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(l.isDirectory()&&!u.isDirectory())throw new Error(`Cannot overwrite non-directory '${t}' with directory '${e}'.`);if(!l.isDirectory()&&u.isDirectory())throw new Error(`Cannot overwrite directory '${t}' with non-directory '${e}'.`)}if(l.isDirectory()&&c(e,t))throw new Error(a(e,t,r));return{srcStat:l,destStat:u}},checkParentPaths:n((async function e(t,r,n,c){const l=o.resolve(o.dirname(t)),u=o.resolve(o.dirname(n));if(u===l||u===o.parse(u).root)return;let d;try{d=await s.stat(u,{bigint:!0})}catch(e){if("ENOENT"===e.code)return;throw e}if(i(r,d))throw new Error(a(t,n,c));return e(t,r,u,c)})),checkParentPathsSync:function e(t,r,n,c){const l=o.resolve(o.dirname(t)),u=o.resolve(o.dirname(n));if(u===l||u===o.parse(u).root)return;let d;try{d=s.statSync(u,{bigint:!0})}catch(e){if("ENOENT"===e.code)return;throw e}if(i(r,d))throw new Error(a(t,n,c));return e(t,r,u,c)},isSrcSubdir:c,areIdentical:i}},318:(e,t,r)=>{"use strict";const s=r(7749),o=r(8981).fromPromise;e.exports={utimesMillis:o((async function(e,t,r){const o=await s.open(e,"r+");let n=null;try{await s.futimes(o,t,r)}finally{try{await s.close(o)}catch(e){n=e}}if(n)throw n})),utimesMillisSync:function(e,t,r){const o=s.openSync(e,"r+");return s.futimesSync(o,t,r),s.closeSync(o)}}},6458:e=>{"use strict";e.exports=function(e){if(null===e||"object"!=typeof e)return e;if(e instanceof Object)var r={__proto__:t(e)};else r=Object.create(null);return Object.getOwnPropertyNames(e).forEach((function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(e,t))})),r};var t=Object.getPrototypeOf||function(e){return e.__proto__}},77:(e,t,r)=>{var s,o,n=r(7147),i=r(2161),c=r(8520),a=r(6458),l=r(3837);function u(e,t){Object.defineProperty(e,s,{get:function(){return t}})}"function"==typeof Symbol&&"function"==typeof Symbol.for?(s=Symbol.for("graceful-fs.queue"),o=Symbol.for("graceful-fs.previous")):(s="___graceful-fs.queue",o="___graceful-fs.previous");var d,f=function(){};if(l.debuglog?f=l.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(f=function(){var e=l.format.apply(l,arguments);e="GFS4: "+e.split(/\n/).join("\nGFS4: "),console.error(e)}),!n[s]){var h=global[s]||[];u(n,h),n.close=function(e){function t(t,r){return e.call(n,t,(function(e){e||y(),"function"==typeof r&&r.apply(this,arguments)}))}return Object.defineProperty(t,o,{value:e}),t}(n.close),n.closeSync=function(e){function t(t){e.apply(n,arguments),y()}return Object.defineProperty(t,o,{value:e}),t}(n.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",(function(){f(n[s]),r(9491).equal(n[s].length,0)}))}function g(e){i(e),e.gracefulify=g,e.createReadStream=function(t,r){return new e.ReadStream(t,r)},e.createWriteStream=function(t,r){return new e.WriteStream(t,r)};var t=e.readFile;e.readFile=function(e,r,s){return"function"==typeof r&&(s=r,r=null),function e(r,s,o,n){return t(r,s,(function(t){!t||"EMFILE"!==t.code&&"ENFILE"!==t.code?"function"==typeof o&&o.apply(this,arguments):p([e,[r,s,o],t,n||Date.now(),Date.now()])}))}(e,r,s)};var r=e.writeFile;e.writeFile=function(e,t,s,o){return"function"==typeof s&&(o=s,s=null),function e(t,s,o,n,i){return r(t,s,o,(function(r){!r||"EMFILE"!==r.code&&"ENFILE"!==r.code?"function"==typeof n&&n.apply(this,arguments):p([e,[t,s,o,n],r,i||Date.now(),Date.now()])}))}(e,t,s,o)};var s=e.appendFile;s&&(e.appendFile=function(e,t,r,o){return"function"==typeof r&&(o=r,r=null),function e(t,r,o,n,i){return s(t,r,o,(function(s){!s||"EMFILE"!==s.code&&"ENFILE"!==s.code?"function"==typeof n&&n.apply(this,arguments):p([e,[t,r,o,n],s,i||Date.now(),Date.now()])}))}(e,t,r,o)});var o=e.copyFile;o&&(e.copyFile=function(e,t,r,s){return"function"==typeof r&&(s=r,r=0),function e(t,r,s,n,i){return o(t,r,s,(function(o){!o||"EMFILE"!==o.code&&"ENFILE"!==o.code?"function"==typeof n&&n.apply(this,arguments):p([e,[t,r,s,n],o,i||Date.now(),Date.now()])}))}(e,t,r,s)});var n=e.readdir;e.readdir=function(e,t,r){"function"==typeof t&&(r=t,t=null);var s=a.test(process.version)?function(e,t,r,s){return n(e,o(e,t,r,s))}:function(e,t,r,s){return n(e,t,o(e,t,r,s))};return s(e,t,r);function o(e,t,r,o){return function(n,i){!n||"EMFILE"!==n.code&&"ENFILE"!==n.code?(i&&i.sort&&i.sort(),"function"==typeof r&&r.call(this,n,i)):p([s,[e,t,r],n,o||Date.now(),Date.now()])}}};var a=/^v[0-5]\./;if("v0.8"===process.version.substr(0,4)){var l=c(e);y=l.ReadStream,m=l.WriteStream}var u=e.ReadStream;u&&(y.prototype=Object.create(u.prototype),y.prototype.open=function(){var e=this;b(e.path,e.flags,e.mode,(function(t,r){t?(e.autoClose&&e.destroy(),e.emit("error",t)):(e.fd=r,e.emit("open",r),e.read())}))});var d=e.WriteStream;d&&(m.prototype=Object.create(d.prototype),m.prototype.open=function(){var e=this;b(e.path,e.flags,e.mode,(function(t,r){t?(e.destroy(),e.emit("error",t)):(e.fd=r,e.emit("open",r))}))}),Object.defineProperty(e,"ReadStream",{get:function(){return y},set:function(e){y=e},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return m},set:function(e){m=e},enumerable:!0,configurable:!0});var f=y;Object.defineProperty(e,"FileReadStream",{get:function(){return f},set:function(e){f=e},enumerable:!0,configurable:!0});var h=m;function y(e,t){return this instanceof y?(u.apply(this,arguments),this):y.apply(Object.create(y.prototype),arguments)}function m(e,t){return this instanceof m?(d.apply(this,arguments),this):m.apply(Object.create(m.prototype),arguments)}Object.defineProperty(e,"FileWriteStream",{get:function(){return h},set:function(e){h=e},enumerable:!0,configurable:!0});var w=e.open;function b(e,t,r,s){return"function"==typeof r&&(s=r,r=null),function e(t,r,s,o,n){return w(t,r,s,(function(i,c){!i||"EMFILE"!==i.code&&"ENFILE"!==i.code?"function"==typeof o&&o.apply(this,arguments):p([e,[t,r,s,o],i,n||Date.now(),Date.now()])}))}(e,t,r,s)}return e.open=b,e}function p(e){f("ENQUEUE",e[0].name,e[1]),n[s].push(e),m()}function y(){for(var e=Date.now(),t=0;t<n[s].length;++t)n[s][t].length>2&&(n[s][t][3]=e,n[s][t][4]=e);m()}function m(){if(clearTimeout(d),d=void 0,0!==n[s].length){var e=n[s].shift(),t=e[0],r=e[1],o=e[2],i=e[3],c=e[4];if(void 0===i)f("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-i>=6e4){f("TIMEOUT",t.name,r);var a=r.pop();"function"==typeof a&&a.call(null,o)}else{var l=Date.now()-c,u=Math.max(c-i,1);l>=Math.min(1.2*u,100)?(f("RETRY",t.name,r),t.apply(null,r.concat([i]))):n[s].push(e)}void 0===d&&(d=setTimeout(m,0))}}global[s]||u(global,n[s]),e.exports=g(a(n)),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!n.__patched&&(e.exports=g(n),n.__patched=!0)},8520:(e,t,r)=>{var s=r(2781).Stream;e.exports=function(e){return{ReadStream:function t(r,o){if(!(this instanceof t))return new t(r,o);s.call(this);var n=this;this.path=r,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,o=o||{};for(var i=Object.keys(o),c=0,a=i.length;c<a;c++){var l=i[c];this[l]=o[l]}if(this.encoding&&this.setEncoding(this.encoding),void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}null===this.fd?e.open(this.path,this.flags,this.mode,(function(e,t){if(e)return n.emit("error",e),void(n.readable=!1);n.fd=t,n.emit("open",t),n._read()})):process.nextTick((function(){n._read()}))},WriteStream:function t(r,o){if(!(this instanceof t))return new t(r,o);s.call(this),this.path=r,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,o=o||{};for(var n=Object.keys(o),i=0,c=n.length;i<c;i++){var a=n[i];this[a]=o[a]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],null===this.fd&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}}},2161:(e,t,r)=>{var s=r(2057),o=process.cwd,n=null,i=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return n||(n=o.call(process)),n};try{process.cwd()}catch(e){}if("function"==typeof process.chdir){var c=process.chdir;process.chdir=function(e){n=null,c.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,c)}e.exports=function(e){function t(t){return t?function(r,s,o){return t.call(e,r,s,(function(e){l(e)&&(e=null),o&&o.apply(this,arguments)}))}:t}function r(t){return t?function(r,s){try{return t.call(e,r,s)}catch(e){if(!l(e))throw e}}:t}function o(t){return t?function(r,s,o,n){return t.call(e,r,s,o,(function(e){l(e)&&(e=null),n&&n.apply(this,arguments)}))}:t}function n(t){return t?function(r,s,o){try{return t.call(e,r,s,o)}catch(e){if(!l(e))throw e}}:t}function c(t){return t?function(r,s,o){function n(e,t){t&&(t.uid<0&&(t.uid+=4294967296),t.gid<0&&(t.gid+=4294967296)),o&&o.apply(this,arguments)}return"function"==typeof s&&(o=s,s=null),s?t.call(e,r,s,n):t.call(e,r,n)}:t}function a(t){return t?function(r,s){var o=s?t.call(e,r,s):t.call(e,r);return o&&(o.uid<0&&(o.uid+=4294967296),o.gid<0&&(o.gid+=4294967296)),o}:t}function l(e){return!e||"ENOSYS"===e.code||!(process.getuid&&0===process.getuid()||"EINVAL"!==e.code&&"EPERM"!==e.code)}var u;s.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&function(e){e.lchmod=function(t,r,o){e.open(t,s.O_WRONLY|s.O_SYMLINK,r,(function(t,s){t?o&&o(t):e.fchmod(s,r,(function(t){e.close(s,(function(e){o&&o(t||e)}))}))}))},e.lchmodSync=function(t,r){var o,n=e.openSync(t,s.O_WRONLY|s.O_SYMLINK,r),i=!0;try{o=e.fchmodSync(n,r),i=!1}finally{if(i)try{e.closeSync(n)}catch(e){}else e.closeSync(n)}return o}}(e),e.lutimes||function(e){s.hasOwnProperty("O_SYMLINK")&&e.futimes?(e.lutimes=function(t,r,o,n){e.open(t,s.O_SYMLINK,(function(t,s){t?n&&n(t):e.futimes(s,r,o,(function(t){e.close(s,(function(e){n&&n(t||e)}))}))}))},e.lutimesSync=function(t,r,o){var n,i=e.openSync(t,s.O_SYMLINK),c=!0;try{n=e.futimesSync(i,r,o),c=!1}finally{if(c)try{e.closeSync(i)}catch(e){}else e.closeSync(i)}return n}):e.futimes&&(e.lutimes=function(e,t,r,s){s&&process.nextTick(s)},e.lutimesSync=function(){})}(e),e.chown=o(e.chown),e.fchown=o(e.fchown),e.lchown=o(e.lchown),e.chmod=t(e.chmod),e.fchmod=t(e.fchmod),e.lchmod=t(e.lchmod),e.chownSync=n(e.chownSync),e.fchownSync=n(e.fchownSync),e.lchownSync=n(e.lchownSync),e.chmodSync=r(e.chmodSync),e.fchmodSync=r(e.fchmodSync),e.lchmodSync=r(e.lchmodSync),e.stat=c(e.stat),e.fstat=c(e.fstat),e.lstat=c(e.lstat),e.statSync=a(e.statSync),e.fstatSync=a(e.fstatSync),e.lstatSync=a(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(e,t,r){r&&process.nextTick(r)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(e,t,r,s){s&&process.nextTick(s)},e.lchownSync=function(){}),"win32"===i&&(e.rename="function"!=typeof e.rename?e.rename:function(t){function r(r,s,o){var n=Date.now(),i=0;t(r,s,(function c(a){if(a&&("EACCES"===a.code||"EPERM"===a.code||"EBUSY"===a.code)&&Date.now()-n<6e4)return setTimeout((function(){e.stat(s,(function(e,n){e&&"ENOENT"===e.code?t(r,s,c):o(a)}))}),i),void(i<100&&(i+=10));o&&o(a)}))}return Object.setPrototypeOf&&Object.setPrototypeOf(r,t),r}(e.rename)),e.read="function"!=typeof e.read?e.read:function(t){function r(r,s,o,n,i,c){var a;if(c&&"function"==typeof c){var l=0;a=function(u,d,f){if(u&&"EAGAIN"===u.code&&l<10)return l++,t.call(e,r,s,o,n,i,a);c.apply(this,arguments)}}return t.call(e,r,s,o,n,i,a)}return Object.setPrototypeOf&&Object.setPrototypeOf(r,t),r}(e.read),e.readSync="function"!=typeof e.readSync?e.readSync:(u=e.readSync,function(t,r,s,o,n){for(var i=0;;)try{return u.call(e,t,r,s,o,n)}catch(e){if("EAGAIN"===e.code&&i<10){i++;continue}throw e}})}},6813:(e,t,r)=>{let s;try{s=r(77)}catch(e){s=r(7147)}const o=r(8981),{stringify:n,stripBom:i}=r(6780),c={readFile:o.fromPromise((async function(e,t={}){"string"==typeof t&&(t={encoding:t});const r=t.fs||s,n=!("throws"in t)||t.throws;let c,a=await o.fromCallback(r.readFile)(e,t);a=i(a);try{c=JSON.parse(a,t?t.reviver:null)}catch(t){if(n)throw t.message=`${e}: ${t.message}`,t;return null}return c})),readFileSync:function(e,t={}){"string"==typeof t&&(t={encoding:t});const r=t.fs||s,o=!("throws"in t)||t.throws;try{let s=r.readFileSync(e,t);return s=i(s),JSON.parse(s,t.reviver)}catch(t){if(o)throw t.message=`${e}: ${t.message}`,t;return null}},writeFile:o.fromPromise((async function(e,t,r={}){const i=r.fs||s,c=n(t,r);await o.fromCallback(i.writeFile)(e,c,r)})),writeFileSync:function(e,t,r={}){const o=r.fs||s,i=n(t,r);return o.writeFileSync(e,i,r)}};e.exports=c},6780:e=>{e.exports={stringify:function(e,{EOL:t="\n",finalEOL:r=!0,replacer:s=null,spaces:o}={}){const n=r?t:"";return JSON.stringify(e,s,o).replace(/\n/g,t)+n},stripBom:function(e){return Buffer.isBuffer(e)&&(e=e.toString("utf8")),e.replace(/^\uFEFF/,"")}}},7363:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCreateChatGPTView=void 0;const s=r(9496),o=r(6677);let n;class i{constructor(e){this.context=e,this.context=e}resolveWebviewView(e){this.webview=e.webview,e.webview.options={enableScripts:!0},e.webview.html=(0,o.getHtmlForWebview)(this.context,e.webview),e.webview.onDidReceiveMessage((e=>{"webviewLoaded"===e.cmd&&console.log("ÂèçÈ¶àÊ∂àÊÅØ:",e)}))}removeWebView(){this.webview=void 0}}const c=e=>{s.commands.executeCommand("workbench.view.extension.DiFlow").then((()=>{s.commands.executeCommand("setContext","DiFlow.chatGPTView",!0).then((()=>{const t=s.workspace.getConfiguration("DiFlow"),r=t.get("hostname"),o=t.get("apiKey"),i=t.get("model");setTimeout((()=>{n&&n?.webview&&n.webview.postMessage({cmd:"vscodePushTask",task:"route",data:{path:"/chat-gpt-view",query:{hostname:r,apiKey:o,selectedText:e,model:i}}})}),500)}))}))};t.registerCreateChatGPTView=e=>{n=new i(e),e.subscriptions.push(s.window.registerWebviewViewProvider("DiFlow.chatGPTView",n,{webviewOptions:{retainContextWhenHidden:!0}})),e.subscriptions.push(s.commands.registerCommand("DiFlow.openChatGPTView",(()=>{c()})),s.commands.registerCommand("DiFlow.hideChatGPTView",(()=>{s.commands.executeCommand("setContext","DiFlow.chatGPTView",!1).then((()=>{n?.removeWebView()}))})),s.commands.registerCommand("DiFlow.explainByChatGPT",(()=>{const e=s.window.activeTextEditor;if(e){const t=e.document.getText(e.selection);if(!t)return void s.window.showInformationMessage("Ê≤°ÊúâÈÄâ‰∏≠ÁöÑÊñáÊú¨");const r=s.workspace.getConfiguration("DiFlow"),o=r.get("hostname"),n=r.get("apiKey");if(!o)return void s.window.showInformationMessage("ËØ∑ÂÖàËÆæÁΩÆÊèí‰ª∂ DiFlow ÁöÑ hostnameÔºåÁÇπÂáªÂ∑¶‰æßÊ†áÁ≠æÊ†è DiFlow ÁöÑÂõæÊ†áËøõË°åËÆæÁΩÆ");if(!n)return void s.window.showInformationMessage("ËØ∑ÂÖàËÆæÁΩÆÊèí‰ª∂ DiFlow ÁöÑ apiKeyÔºåÁÇπÂáªÂ∑¶‰æßÊ†áÁ≠æÊ†è DiFlow ÁöÑÂõæÊ†áËøõË°åËÆæÁΩÆ");c(t)}else s.window.showInformationMessage("Ê≤°ÊúâÊ¥ªÂä®ÁöÑÊñáÊú¨ÁºñËæëÂô®")})))}},7413:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCreateScript=void 0;const s=r(9496),o=r(1017),n=r(9496),i=r(5674);async function c(e,t){await i.ensureDir(t);const r=await i.readdir(e);for(const s of r){const r=o.join(e,s),n=o.join(t,s);(await i.stat(r)).isDirectory()?await c(r,n):await i.copyFile(r,n)}}t.registerCreateScript=e=>{e.subscriptions.push(n.commands.registerCommand("DiFlow.createScript",(async e=>{const t=s.workspace.rootPath||"",r=o.join(t,"materials","blocks"),n=e._fsPath;if(r)if(n)try{await c(r,n),s.window.showInformationMessage("Â§çÂà∂Êñá‰ª∂Â§πÂÜÖÂÆπÊàêÂäü")}catch(e){s.window.showErrorMessage("Â§çÂà∂Êñá‰ª∂Â§πÂÜÖÂÆπÂ§±Ë¥•")}else s.window.showErrorMessage("ËØ∑ÈÄâÊã©ÁõÆÊ†áÊñá‰ª∂Â§π");else s.window.showErrorMessage("ËØ∑ÈÄâÊã©Êù•Ê∫êÊñá‰ª∂Â§π")})))}},4116:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCreateSetting=void 0;const s=r(9496);t.registerCreateSetting=e=>{e.subscriptions.push(s.commands.registerCommand("DiFlow.openSetting",(()=>{s.commands.executeCommand("workbench.action.openSettings","DiFlow")})))}},7093:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCreateSnippets=void 0;const s=r(9496),o=r(6677);t.registerCreateSnippets=e=>{e.subscriptions.push(s.commands.registerCommand("DiFlow.createSnippets",(async()=>{(0,o.showWebView)(e,{key:"main",title:"Ê∑ªÂä†‰ª£Á†ÅÁâáÊÆµ",viewColumn:1,task:{task:"route",data:{path:"/add-snippets"}}})})))}},6862:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerCursorManagement=t.registerCursorIntegration=t.CursorIntegration=void 0;const s=r(7147),o=r(1017),n=r(2037),i=r(9496);class c{constructor(){this.configPaths={},this.logger={debug:(e,...t)=>console.log(`[DEBUG] ${e}`,...t),warn:(e,...t)=>console.warn(`[WARN] ${e}`,...t),error:(e,...t)=>console.error(`[ERROR] ${e}`,...t)},this.platform=n.platform(),this.detectConfigPaths()}setCustomInstallPath(e){console.log("ËÆæÁΩÆËá™ÂÆö‰πâ Cursor ÂÆâË£ÖË∑ØÂæÑ:",e),this.configPaths.customInstallPath=e,this.detectConfigPaths()}detectConfigPaths(){console.log("ÂºÄÂßãÂä®ÊÄÅÊ£ÄÊµã Cursor ÈÖçÁΩÆË∑ØÂæÑ..."),this.configPaths.settingsPath=this.findSettingsPath(),this.configPaths.mcpPath=this.findMcpPath(),this.configPaths.rulesPath=this.findRulesPath(),this.configPaths.cliPath=this.findCliPath(),console.log("ÈÖçÁΩÆË∑ØÂæÑÊ£ÄÊµãÁªìÊûú:",this.configPaths)}findSettingsPath(){const e=n.homedir(),t=[];if("win32"===this.platform)t.push(o.join(e,"AppData","Roaming","Cursor","User","settings.json"),o.join(e,"AppData","Local","Cursor","User","settings.json"));else if("darwin"===this.platform){const r=o.join(e,"Library","Application Support","Cursor","User","settings.json");t.push(r),console.log("macOS ÈÖçÁΩÆÊñá‰ª∂Ë∑ØÂæÑ:",r)}else t.push(o.join(e,".config","Cursor","User","settings.json"),o.join(e,".cursor","settings.json"));for(const e of t)if(console.log("Ê£ÄÊü•ÈÖçÁΩÆÊñá‰ª∂Ë∑ØÂæÑ:",e),s.existsSync(e))return console.log("ÊâæÂà∞ settings.json:",e),e;console.log("Êú™ÊâæÂà∞ settings.json Êñá‰ª∂ÔºåÊ£ÄÊü•ÁöÑË∑ØÂæÑ:",t)}findMcpPath(){const e=n.homedir();let t=[];t="darwin"===this.platform?[o.join(e,".cursor","mcp.json"),o.join(e,"mcp.json"),o.join(e,"Library","Application Support","Cursor","User","globalStorage","rooveterinaryinc.cursor-mcp","settings.json"),o.join(e,"Library","Application Support","Cursor","User","settings.json")]:"win32"===this.platform?[o.join(e,".cursor","mcp.json"),o.join(e,"mcp.json"),o.join(e,"AppData","Roaming","Cursor","User","globalStorage","rooveterinaryinc.cursor-mcp","settings.json"),o.join(e,"AppData","Roaming","Cursor","User","settings.json")]:[o.join(e,".cursor","mcp.json"),o.join(e,"mcp.json"),o.join(e,".config","Cursor","User","globalStorage","rooveterinaryinc.cursor-mcp","settings.json"),o.join(e,".config","Cursor","User","settings.json")],console.log("Ê£ÄÊü• Cursor MCP ÈÖçÁΩÆË∑ØÂæÑ:",t);for(const e of t)if(console.log("Ê£ÄÊü• MCP Ë∑ØÂæÑ:",e),s.existsSync(e))return console.log("ÊâæÂà∞ MCP ÈÖçÁΩÆÊñá‰ª∂:",e),e;const r=t[0];return console.log("‰ΩøÁî®ÈªòËÆ§ MCP ÈÖçÁΩÆË∑ØÂæÑ:",r),r}findRulesPath(){const e=o.join(process.cwd(),".cursorrules");if(s.existsSync(e))return console.log("ÊâæÂà∞Â∑•‰ΩúÂå∫ .cursorrules:",e),e;const t=o.join(n.homedir(),".cursorrules");return s.existsSync(t)?(console.log("ÊâæÂà∞Áî®Êà∑‰∏ªÁõÆÂΩï .cursorrules:",t),t):(console.log("‰ΩøÁî®ÈªòËÆ§ .cursorrules Ë∑ØÂæÑ:",e),e)}findCliPath(){try{const{execSync:e}=r(2081);if(this.configPaths.customInstallPath){const e=this.getCliPathsFromInstallDir(this.configPaths.customInstallPath);for(const t of e)if(s.existsSync(t))return console.log("ÊâæÂà∞Ëá™ÂÆö‰πâË∑ØÂæÑ CLI:",t),t}try{const t=e("win32"===this.platform?"where cursor":"which cursor",{encoding:"utf8",timeout:3e3}).trim().split("\n")[0];if(t&&s.existsSync(t))return console.log("ÈÄöËøá which/where ÊâæÂà∞ CLI:",t),t}catch(e){console.log("which/where ÂëΩ‰ª§Êú™ÊâæÂà∞ cursor")}return"darwin"===this.platform?this.findCliMacOS():"win32"===this.platform?this.findCliWindows():this.findCliLinux()}catch(e){return void console.error("Êü•Êâæ CLI Â∑•ÂÖ∑Êó∂Âá∫Èîô:",e)}}getCliPathsFromInstallDir(e){const t=[];return"darwin"===this.platform?e.endsWith(".app")?t.push(o.join(e,"Contents","Resources","app","bin","cursor"),o.join(e,"Contents","MacOS","Cursor"),o.join(e,"Contents","Resources","cursor")):t.push(e):"win32"===this.platform?e.endsWith(".exe")?t.push(e):t.push(o.join(e,"Cursor.exe"),o.join(e,"cursor.exe")):t.push(e,o.join(e,"cursor")),t}findCliMacOS(){try{const{execSync:e}=r(2081),t=["/Applications/Cursor.app",o.join(n.homedir(),"Applications","Cursor.app")];try{console.log("‰ΩøÁî® mdfind ÊêúÁ¥¢ Cursor Â∫îÁî®...");const r=e('mdfind "kMDItemCFBundleIdentifier == com.todesktop.230313mzl4w4u92" 2>/dev/null',{encoding:"utf8",timeout:5e3}).trim();r&&t.push(...r.split("\n"))}catch(e){console.log("mdfind Êü•ÊâæÂ§±Ë¥•ÔºåÂ∞ÜÁªßÁª≠‰ΩøÁî®Â∏∏ËßÑË∑ØÂæÑÊêúÁ¥¢...")}const i=[...new Set(t)].filter(Boolean);console.log("Ê≠£Âú®ÊêúÁ¥¢‰ª•‰∏ãÂ∫îÁî®Ë∑ØÂæÑ:",i);for(const e of i)if(e&&s.existsSync(e)){console.log("ÊâæÂà∞ÊΩúÂú®ÁöÑ Cursor Â∫îÁî®:",e);const t=o.join(e,"Contents","Resources","app","bin","cursor");if(s.existsSync(t))return console.log("ÊàêÂäüÊâæÂà∞ macOS CLI:",t),t}}catch(e){console.error("macOS CLI Êü•ÊâæÂá∫Èîô:",e)}console.log("Âú® macOS ‰∏äÊú™ÊâæÂà∞‰ªª‰ΩïÂèØÊâßË°åÁöÑ Cursor CLI Â∑•ÂÖ∑„ÄÇ")}findCliWindows(){const e=[o.join(n.homedir(),"AppData","Local","Programs","cursor","Cursor.exe"),o.join("C:","Program Files","Cursor","Cursor.exe"),o.join("C:","Program Files (x86)","Cursor","Cursor.exe")];for(const t of e)if(s.existsSync(t))return console.log("ÊâæÂà∞ Windows CLI:",t),t}findCliLinux(){const e=["/usr/bin/cursor","/usr/local/bin/cursor",o.join(n.homedir(),".local","bin","cursor"),"/opt/cursor/cursor","/snap/bin/cursor"];for(const t of e)if(s.existsSync(t))return console.log("ÊâæÂà∞ Linux CLI:",t),t}async isCursorInstalled(){try{console.log("=== Cursor ÂÆâË£ÖÊ£ÄÊµãÂºÄÂßã ==="),this.detectConfigPaths(),console.log("=== Âº∫Âà∂Ê£ÄÊµãÊ≠•È™§ ===");const e={app:"/Applications/Cursor.app",cli:"/Applications/Cursor.app/Contents/Resources/app/bin/cursor",settings:o.join(n.homedir(),"Library","Application Support","Cursor","User","settings.json")};let t=!1;if(console.log("Âº∫Âà∂Ê£ÄÊµãË∑ØÂæÑ:",e),s.existsSync(e.app)&&(console.log("‚úÖ Âº∫Âà∂Ê£ÄÊµã: ÊâæÂà∞ Cursor Â∫îÁî®"),t=!0),s.existsSync(e.cli)&&(console.log("‚úÖ Âº∫Âà∂Ê£ÄÊµã: ÊâæÂà∞ Cursor CLI"),this.configPaths.cliPath=e.cli,t=!0),s.existsSync(e.settings)&&(console.log("‚úÖ Âº∫Âà∂Ê£ÄÊµã: ÊâæÂà∞ Cursor ÈÖçÁΩÆÊñá‰ª∂"),this.configPaths.settingsPath=e.settings,t=!0),t)return console.log("=== Âº∫Âà∂Ê£ÄÊµãÊàêÂäüÔºåCursor Â∑≤ÂÆâË£Ö ==="),!0;if(this.configPaths.cliPath&&s.existsSync(this.configPaths.cliPath))return console.log(`Ê£ÄÊµãÊàêÂäü: ÊâæÂà∞ CLI Â∑•ÂÖ∑Ë∑ØÂæÑ '${this.configPaths.cliPath}'`),!0;if(console.log("Ê£ÄÊµã‰ø°ÊÅØ: Êú™ËÉΩÈÄöËøá CLI Ë∑ØÂæÑÁõ¥Êé•Á°ÆËÆ§ÂÆâË£Ö„ÄÇ"),this.configPaths.settingsPath&&s.existsSync(this.configPaths.settingsPath))return console.log(`Ê£ÄÊµãÊàêÂäü: ÊâæÂà∞ÈÖçÁΩÆÊñá‰ª∂Ë∑ØÂæÑ '${this.configPaths.settingsPath}'`),!0;if(console.log("Ê£ÄÊµã‰ø°ÊÅØ: Êú™ËÉΩÈÄöËøáÈÖçÁΩÆÊñá‰ª∂Á°ÆËÆ§ÂÆâË£Ö„ÄÇ"),this.checkAppInstallation())return console.log("Ê£ÄÊµãÊàêÂäü: ÊâæÂà∞‰∫ÜÂ∫îÁî®ÂÆâË£ÖÁõÆÂΩï (‰ΩÜÊú™ÊâæÂà∞ÊòéÁ°ÆÁöÑ CLI ÊàñÈÖçÁΩÆÊñá‰ª∂)„ÄÇ"),!0;console.log("Ê£ÄÊµã‰ø°ÊÅØ: Êú™ËÉΩÈÄöËøáÂ∫îÁî®ÁõÆÂΩïÁ°ÆËÆ§ÂÆâË£Ö„ÄÇ");try{const{execSync:e}=r(2081);return e("cursor --version",{timeout:3e3,stdio:"ignore"}),console.log("Ê£ÄÊµãÊàêÂäü: `cursor --version` ÂëΩ‰ª§ÊâßË°åÊàêÂäü„ÄÇ"),!0}catch(e){console.log(`Ê£ÄÊµã‰ø°ÊÅØ: 'cursor --version' ÂëΩ‰ª§ÊâßË°åÂ§±Ë¥•: ${e.message}`)}return console.log("=== Cursor Êú™Ê£ÄÊµãÂà∞ ==="),!1}catch(e){return console.error("Ê£ÄÊµã Cursor ÂÆâË£ÖÁä∂ÊÄÅÊó∂ÂèëÁîüÊÑèÂ§ñÈîôËØØ:",e),!1}}checkAppInstallation(){try{if("darwin"===this.platform){const e=["/Applications/Cursor.app",o.join(n.homedir(),"Applications","Cursor.app")];for(const t of e)if(s.existsSync(t))return console.log("ÊâæÂà∞ Cursor Â∫îÁî®:",t),!0}else if("win32"===this.platform){const e=[o.join(n.homedir(),"AppData","Local","Programs","cursor"),o.join("C:","Program Files","Cursor"),o.join("C:","Program Files (x86)","Cursor")];for(const t of e)if(s.existsSync(t))return console.log("ÊâæÂà∞ Cursor ÂÆâË£ÖÁõÆÂΩï:",t),!0}else{const e=["/opt/cursor","/usr/local/bin/cursor","/usr/bin/cursor",o.join(n.homedir(),".local","bin","cursor")];for(const t of e)if(s.existsSync(t))return console.log("ÊâæÂà∞ Cursor ÂÆâË£Ö:",t),!0}}catch(e){console.error("Ê£ÄÊü•Â∫îÁî®ÂÆâË£ÖÊó∂Âá∫Èîô:",e)}return!1}async getCursorSettings(){const e={};try{if(this.configPaths.rulesPath&&s.existsSync(this.configPaths.rulesPath)?e.rules=s.readFileSync(this.configPaths.rulesPath,"utf-8"):e.rules="",this.configPaths.settingsPath&&s.existsSync(this.configPaths.settingsPath)){const t=s.readFileSync(this.configPaths.settingsPath,"utf-8");try{e.generalConfig=JSON.parse(t)}catch(t){console.warn("Ëß£Êûê settings.json Â§±Ë¥•:",t),e.generalConfig={}}}else e.generalConfig={};if(this.configPaths.mcpPath&&s.existsSync(this.configPaths.mcpPath)){const t=s.readFileSync(this.configPaths.mcpPath,"utf-8");try{e.mcpConfig=JSON.parse(t)}catch(t){console.warn("Ëß£Êûê MCP ÈÖçÁΩÆÂ§±Ë¥•:",t),e.mcpConfig={mcpServers:{}}}}else e.mcpConfig={mcpServers:{}}}catch(e){throw console.error("Ëé∑Âèñ Cursor ËÆæÁΩÆÂ§±Ë¥•:",e),new Error(`Ëé∑Âèñ Cursor ËÆæÁΩÆÂ§±Ë¥•: ${e}`)}return e}async updateCursorSettings(e){try{if(void 0!==e.rules&&this.configPaths.rulesPath){const t=o.dirname(this.configPaths.rulesPath);s.existsSync(t)||s.mkdirSync(t,{recursive:!0}),s.writeFileSync(this.configPaths.rulesPath,e.rules,"utf-8")}if(void 0!==e.generalConfig&&this.configPaths.settingsPath){const t=o.dirname(this.configPaths.settingsPath);s.existsSync(t)||s.mkdirSync(t,{recursive:!0});let r={};if(s.existsSync(this.configPaths.settingsPath))try{const e=s.readFileSync(this.configPaths.settingsPath,"utf-8");r=JSON.parse(e)}catch(e){console.warn("Ëß£ÊûêÁé∞Êúâ settings.json Â§±Ë¥•ÔºåÂ∞ÜÂàõÂª∫Êñ∞ÈÖçÁΩÆ:",e)}const n={...r,...e.generalConfig};s.writeFileSync(this.configPaths.settingsPath,JSON.stringify(n,null,2),"utf-8")}if(void 0!==e.mcpConfig&&this.configPaths.mcpPath){const t=o.dirname(this.configPaths.mcpPath);s.existsSync(t)||s.mkdirSync(t,{recursive:!0});let r={mcpServers:{}};if(s.existsSync(this.configPaths.mcpPath))try{const e=s.readFileSync(this.configPaths.mcpPath,"utf-8");r=JSON.parse(e)}catch(e){console.warn("Ëß£ÊûêÁé∞Êúâ MCP ÈÖçÁΩÆÂ§±Ë¥•ÔºåÂ∞ÜÂàõÂª∫Êñ∞ÈÖçÁΩÆ:",e)}const n={...r,...e.mcpConfig,mcpServers:{...r.mcpServers,...e.mcpConfig.mcpServers}};s.writeFileSync(this.configPaths.mcpPath,JSON.stringify(n,null,2),"utf-8")}return!0}catch(e){throw console.error("Êõ¥Êñ∞ Cursor ËÆæÁΩÆÂ§±Ë¥•:",e),new Error(`Êõ¥Êñ∞ Cursor ËÆæÁΩÆÂ§±Ë¥•: ${e}`)}}async openCursor(e){try{const{exec:t}=r(2081);let s;if("darwin"===this.platform)s=e?`open -a "Cursor" "${e}"`:'open -a "Cursor" --new';else{const t=this.configPaths.cliPath||"cursor";s=`"${t}"`,s+=e?` "${e}"`:" --new-window"}return console.log("ÊâßË°åÂëΩ‰ª§:",s),new Promise(((e,r)=>{t(s,((t,s,o)=>{t?(console.error("ÊâìÂºÄ Cursor Â§±Ë¥•:",t),r(new Error(`ÊâìÂºÄ Cursor Â§±Ë¥•: ${t.message}`))):(console.log("Cursor ÊâìÂºÄÊàêÂäü"),e(!0))}))}))}catch(e){throw console.error("ÊâìÂºÄ Cursor Â§±Ë¥•:",e),new Error(`ÊâìÂºÄ Cursor Â§±Ë¥•: ${e}`)}}async openCursorChat(e){this.logger.debug("ÂºÄÂßãÊâìÂºÄ Cursor Chat...");try{if(!e){const t=await i.window.showInputBox({prompt:"ËØ∑ËæìÂÖ•Ë¶ÅÂèëÈÄÅÂà∞ Cursor Chat ÁöÑÊ∂àÊÅØ",placeHolder:"ËæìÂÖ•ÊÇ®ÁöÑÈóÆÈ¢òÊàñËØ∑Ê±Ç..."});if(!t)return i.window.showInformationMessage("‚ùå Â∑≤ÂèñÊ∂àÂèëÈÄÅÊ∂àÊÅØ"),!1;e=t}await i.env.clipboard.writeText(e),this.logger.debug("‚úÖ Ê∂àÊÅØÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø"),this.logger.debug("Ê≠£Âú®ÊâìÂºÄËÅäÂ§©ÁïåÈù¢...");try{await i.commands.executeCommand("aichat.newchataction"),this.logger.debug("‚úÖ ÊàêÂäüÊâßË°å aichat.newchataction")}catch(e){this.logger.warn("‚ö†Ô∏è aichat.newchataction Â§±Ë¥•ÔºåÂ∞ùËØïÂÖ∂‰ªñÂëΩ‰ª§");try{await i.commands.executeCommand("workbench.action.chat.open"),this.logger.debug("‚úÖ ÊàêÂäüÊâßË°å workbench.action.chat.open")}catch(e){this.logger.warn("‚ö†Ô∏è workbench.action.chat.open Â§±Ë¥•ÔºåÂ∞ùËØïÊúÄÂêé‰∏Ä‰∏™ÂëΩ‰ª§"),await i.commands.executeCommand("workbench.action.chat.newChat"),this.logger.debug("‚úÖ ÊàêÂäüÊâßË°å workbench.action.chat.newChat")}}await new Promise((e=>setTimeout(e,2500))),this.logger.debug("‚è±Ô∏è Á≠âÂæÖÁïåÈù¢Âä†ËΩΩÂÆåÊàê");try{await i.commands.executeCommand("workbench.action.chat.focusInput"),this.logger.debug("‚úÖ ÊàêÂäüËÅöÁÑ¶Âà∞ËÅäÂ§©ËæìÂÖ•Ê°Ü"),await new Promise((e=>setTimeout(e,500)))}catch(e){this.logger.warn("‚ö†Ô∏è ËÅöÁÑ¶ÂëΩ‰ª§Â§±Ë¥•ÔºåÁªßÁª≠ÊâßË°å")}let t=!1;if("darwin"===this.platform){this.logger.debug("üéØ ‰ΩøÁî®‰ºòÂåñÁöÑ AppleScript ÊñπÊ≥ïÂèëÈÄÅÊ∂àÊÅØ");try{const{exec:e}=r(2081),{promisify:s}=r(3837),o=s(e),n='\n            tell application "System Events"\n              -- Ê£ÄÊü• Cursor ÊòØÂê¶Â∑≤ÁªèÂú®ËøêË°åÔºå‰∏çÂº∫Âà∂ÊøÄÊ¥ª\n              if (exists (processes whose name is "Cursor")) then\n                -- Áõ¥Êé•Êìç‰ΩúÂΩìÂâçÊ¥ªÂä®Á™óÂè£Ôºå‰∏çÂàáÊç¢Â∫îÁî®\n                delay 0.3\n                \n                -- Ê∏ÖÁ©∫ÂΩìÂâçËæìÂÖ•ÂÜÖÂÆπÔºàÊ∏©ÂíåÊñπÂºèÔºâ\n                key code 0 using {command down} -- Cmd+A ÂÖ®ÈÄâ\n                delay 0.1\n                key code 51 -- Delete ÈîÆÂà†Èô§ÂÜÖÂÆπ\n                delay 0.1\n                \n                -- Á≤òË¥¥Ê∂àÊÅØÂÜÖÂÆπ\n                key code 9 using {command down} -- Cmd+V Á≤òË¥¥\n                delay 0.3\n                \n                -- ÂèëÈÄÅÊ∂àÊÅØÔºöÊåâ Enter ÈîÆ\n                key code 36 -- Enter ÈîÆ\n                delay 0.2\n                \n              else\n                error "Cursor Â∫îÁî®Êú™ËøêË°å"\n              end if\n            end tell\n          ';this.logger.debug("ÊâßË°å‰ºòÂåñÁöÑ AppleScript ÈîÆÁõòÊ®°Êãü..."),await o(`osascript -e '${n}'`),this.logger.debug("‚úÖ AppleScript ÊâßË°åÂÆåÊàê"),t=!0}catch(r){this.logger.error("‚ùå AppleScript ÊâßË°åÂ§±Ë¥•:",r),t=await this.fallbackSendMethod(e)}}else if("win32"===this.platform){this.logger.debug("üéØ ‰ΩøÁî® PowerShell ÊñπÊ≥ïÂèëÈÄÅÊ∂àÊÅØÔºàWindowsÔºâ");try{const{exec:e}=r(2081),{promisify:s}=r(3837),o=s(e),n='\n            Add-Type -AssemblyName System.Windows.Forms\n            \n            # Á≠âÂæÖ‰∏Ä‰∏ãÁ°Æ‰øùÁÑ¶ÁÇπÊ≠£Á°Æ\n            Start-Sleep -Milliseconds 300\n            \n            # ÂÖ®ÈÄâÂΩìÂâçÂÜÖÂÆπ\n            [System.Windows.Forms.SendKeys]::SendWait("^a")\n            Start-Sleep -Milliseconds 100\n            \n            # Âà†Èô§ÂÜÖÂÆπ\n            [System.Windows.Forms.SendKeys]::SendWait("{DELETE}")\n            Start-Sleep -Milliseconds 100\n            \n            # Á≤òË¥¥Ê∂àÊÅØ\n            [System.Windows.Forms.SendKeys]::SendWait("^v")\n            Start-Sleep -Milliseconds 300\n            \n            # ÂèëÈÄÅÊ∂àÊÅØÔºàEnter ÈîÆÔºâ\n            [System.Windows.Forms.SendKeys]::SendWait("{ENTER}")\n            Start-Sleep -Milliseconds 200\n          ';this.logger.debug("ÊâßË°å PowerShell ÈîÆÁõòÊ®°Êãü..."),await o(`powershell -Command "${n.replace(/"/g,'\\"')}"`,{windowsHide:!0}),this.logger.debug("‚úÖ PowerShell ÊâßË°åÂÆåÊàê"),t=!0}catch(r){this.logger.error("‚ùå PowerShell ÊâßË°åÂ§±Ë¥•:",r),t=await this.fallbackSendMethod(e)}}else{this.logger.debug("üéØ ‰ΩøÁî® Linux ÊñπÊ≥ïÂèëÈÄÅÊ∂àÊÅØ");try{const{exec:s}=r(2081),{promisify:o}=r(3837),n=o(s);try{await n("which xdotool",{timeout:1e3});const e=["sleep 0.3","xdotool key ctrl+a","sleep 0.1","xdotool key Delete","sleep 0.1","xdotool key ctrl+v","sleep 0.3","xdotool key Return","sleep 0.2"].join(" && ");this.logger.debug("ÊâßË°å xdotool ÈîÆÁõòÊ®°Êãü..."),await n(e),this.logger.debug("‚úÖ xdotool ÊâßË°åÂÆåÊàê"),t=!0}catch(r){this.logger.warn("‚ö†Ô∏è xdotool ‰∏çÂèØÁî®Ôºå‰ΩøÁî®ÂõûÈÄÄÊñπÊ≥ï"),t=await this.fallbackSendMethod(e)}}catch(r){this.logger.error("‚ùå Linux ÊñπÊ≥ïÊâßË°åÂ§±Ë¥•:",r),t=await this.fallbackSendMethod(e)}}return await new Promise((e=>setTimeout(e,800))),t?(i.window.showInformationMessage(`‚úÖ Ê∂àÊÅØÂ∑≤ÂèëÈÄÅÂà∞ Cursor Chat: "${e}"`),this.logger.debug("üéâ Cursor Chat Êìç‰ΩúÂÆåÊàêÔºåÊ∂àÊÅØÂèëÈÄÅÊàêÂäü"),!0):(i.window.showWarningMessage(`‚ö†Ô∏è Ëá™Âä®ÂèëÈÄÅÂ§±Ë¥•ÔºåÊ∂àÊÅØÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥ÊùøÔºåËØ∑ÊâãÂä®Á≤òË¥¥Âπ∂ÂèëÈÄÅ„ÄÇÊ∂àÊÅØÂÜÖÂÆπ: "${e}"`),this.logger.debug("‚ö†Ô∏è Ëá™Âä®ÂèëÈÄÅÂ§±Ë¥•ÔºåÈúÄË¶ÅÊâãÂä®Êìç‰Ωú"),!1)}catch(e){return this.logger.error("‚ùå ÊâìÂºÄ Cursor Chat Êó∂ÂèëÁîüÈîôËØØ:",e),i.window.showErrorMessage(`‚ùå ÊâìÂºÄ Cursor Chat Â§±Ë¥•: ${e}`),!1}}async fallbackSendMethod(e){this.logger.debug("üîÑ ‰ΩøÁî®ÂõûÈÄÄÊñπÊ≥ïÂèëÈÄÅÊ∂àÊÅØ");try{await i.commands.executeCommand("editor.action.clipboardPasteAction"),await new Promise((e=>setTimeout(e,500))),this.logger.debug("‚úÖ ÂõûÈÄÄÊñπÊ≥ï: Ê∂àÊÅØÁ≤òË¥¥ÂÆåÊàê");for(let e=0;e<2;e++)try{await i.commands.executeCommand("type",{text:"\n"}),await new Promise((e=>setTimeout(e,300))),this.logger.debug(`‚úÖ ÂõûÈÄÄÊñπÊ≥ï: Enter ÈîÆÂ∞ùËØï ${e+1} ÂÆåÊàê`)}catch(t){this.logger.debug(`‚ö†Ô∏è ÂõûÈÄÄÊñπÊ≥ï: Enter ÈîÆÂ∞ùËØï ${e+1} Â§±Ë¥•:`,t)}return this.logger.debug("‚úÖ ÂõûÈÄÄÊñπÊ≥ïÊâßË°åÂÆåÊàê"),!0}catch(e){return this.logger.error("‚ùå ÂõûÈÄÄÊñπÊ≥ï‰πüÂ§±Ë¥•:",e),!1}}async getMcpServers(){try{this.detectConfigPaths();const e=this.configPaths.mcpPath;if(console.log("Ëé∑Âèñ MCP ÊúçÂä°Âô® - ‰ΩøÁî®Ë∑ØÂæÑ:",e),!e)return console.log("MCP ÈÖçÁΩÆË∑ØÂæÑÊú™ÊâæÂà∞"),{};if(!s.existsSync(e)){console.log("MCP ÈÖçÁΩÆÊñá‰ª∂‰∏çÂ≠òÂú®ÔºåÂàõÂª∫Á©∫ÈÖçÁΩÆ:",e);try{const t=o.dirname(e);s.existsSync(t)||s.mkdirSync(t,{recursive:!0});const r={mcpServers:{}};s.writeFileSync(e,JSON.stringify(r,null,2),"utf8"),console.log("Â∑≤ÂàõÂª∫Á©∫ÁöÑ MCP ÈÖçÁΩÆÊñá‰ª∂")}catch(e){console.error("ÂàõÂª∫ MCP ÈÖçÁΩÆÊñá‰ª∂Â§±Ë¥•:",e)}return{}}const t=s.readFileSync(e,"utf8");let r;try{r=JSON.parse(t)}catch(e){return console.error("MCP ÈÖçÁΩÆÊñá‰ª∂ JSON Ëß£ÊûêÂ§±Ë¥•:",e),{}}console.log("MCP ÈÖçÁΩÆÂÜÖÂÆπ:",r);let n={};r.mcpServers&&"object"==typeof r.mcpServers?n=r.mcpServers:r.mcp&&r.mcp.mcpServers?n=r.mcp.mcpServers:r["mcp.mcpServers"]?n=r["mcp.mcpServers"]:"object"!=typeof r||Array.isArray(r)||Object.values(r).every((e=>e&&"object"==typeof e&&"command"in e))&&(n=r);const i={};for(const[e,t]of Object.entries(n))e&&""!==e.trim()&&t&&"object"==typeof t?t.command?i[e]={...t,command:t.command,args:t.args||[],env:t.env||{}}:console.log("Ë∑≥ËøáÁº∫Â∞ë command Â≠óÊÆµÁöÑ MCP ÊúçÂä°Âô®:",e):console.log("Ë∑≥ËøáÊó†ÊïàÁöÑ MCP ÊúçÂä°Âô®ÈÖçÁΩÆ:",{name:e,serverConfig:t});return console.log("ÊúâÊïàÁöÑ MCP ÊúçÂä°Âô®ÈÖçÁΩÆ:",i),i}catch(e){return console.error("Error reading MCP configuration:",e),{}}}async addMcpServer(e,t){try{const r=await this.getCursorSettings();return r.mcpConfig||(r.mcpConfig={mcpServers:{}}),r.mcpConfig.mcpServers||(r.mcpConfig.mcpServers={}),r.mcpConfig.mcpServers[e]=t,await this.updateCursorSettings({mcpConfig:r.mcpConfig})}catch(e){throw console.error("Ê∑ªÂä† MCP ÊúçÂä°Âô®Â§±Ë¥•:",e),e}}async removeMcpServer(e){try{const t=await this.getCursorSettings();if(t.mcpConfig?.mcpServers?.[e]){if(delete t.mcpConfig.mcpServers[e],this.configPaths.mcpPath){const e=o.dirname(this.configPaths.mcpPath);s.existsSync(e)||s.mkdirSync(e,{recursive:!0}),s.writeFileSync(this.configPaths.mcpPath,JSON.stringify(t.mcpConfig,null,2),"utf-8")}return console.log(`MCP ÊúçÂä°Âô® ${e} Â∑≤Âà†Èô§`),!0}return console.log(`MCP ÊúçÂä°Âô® ${e} ‰∏çÂ≠òÂú®`),!0}catch(e){throw console.error("Âà†Èô§ MCP ÊúçÂä°Âô®Â§±Ë¥•:",e),e}}async getUserRules(){try{const e=this.findRulesPath();if(!e||!s.existsSync(e))return console.log("Rules file not found:",e),"";const t=s.readFileSync(e,"utf8");return console.log("ËØªÂèñÂà∞ÁöÑËßÑÂàôÂÜÖÂÆπ:",t),t}catch(e){return console.error("Error reading user rules:",e),""}}async getProjectCursorRules(){try{console.log("ÂºÄÂßãËé∑ÂèñÈ°πÁõÆ .cursor/rules/ ÁõÆÂΩï‰∏ãÁöÑËßÑÂàôÊñá‰ª∂...");const e=i.workspace.workspaceFolders;if(!e||0===e.length)return console.log("Êú™ÊâæÂà∞Â∑•‰ΩúÂå∫Êñá‰ª∂Â§π"),{success:!0,rules:[]};const t=e[0].uri.fsPath,r=o.join(t,".cursor","rules");if(console.log("Â∑•‰ΩúÂå∫Ë∑ØÂæÑ:",t),console.log("Ê£ÄÊü•ËßÑÂàôÁõÆÂΩï:",r),!s.existsSync(r))return console.log("È°πÁõÆ‰∏≠‰∏çÂ≠òÂú® .cursor/rules/ ÁõÆÂΩï"),{success:!0,rules:[]};const n=s.readdirSync(r).filter((e=>e.endsWith(".mdc")));console.log("ÊâæÂà∞ÁöÑ .mdc Êñá‰ª∂:",n);const c=[];for(const e of n){const t=o.join(r,e),n=s.readFileSync(t,"utf8");let i={},a=n;if(n.startsWith("---\n")){const e=n.indexOf("\n---\n");if(e>0){const t=n.substring(4,e);a=n.substring(e+5);try{const e=t.split("\n");for(const t of e){const e=t.indexOf(":");if(e>0){const r=t.substring(0,e).trim();let s=t.substring(e+1).trim();(s.startsWith('"')&&s.endsWith('"')||s.startsWith("'")&&s.endsWith("'"))&&(s=s.slice(1,-1)),s&&""!==s&&("alwaysApply"===r?i.alwaysApply="true"===s:"description"===r?i.description=s:"globs"===r&&(i.globs=s))}}}catch(e){console.warn("Ëß£ÊûêÊñá‰ª∂ÂÖÉÊï∞ÊçÆÂ§±Ë¥•:",e)}}}c.push({name:e.replace(".mdc",""),path:t,content:a.trim(),metadata:i}),console.log(`Ëß£ÊûêËßÑÂàôÊñá‰ª∂ ${e}:`,{name:e.replace(".mdc",""),contentLength:a.trim().length,metadata:i})}return console.log(`ÊàêÂäüËØªÂèñ ${c.length} ‰∏™ËßÑÂàôÊñá‰ª∂`),{success:!0,rules:c}}catch(e){return console.error("Ëé∑ÂèñÈ°πÁõÆËßÑÂàôÊñá‰ª∂Â§±Ë¥•:",e),{success:!1,rules:[],error:e instanceof Error?e.message:String(e)}}}async getCursorSettingsUserRule(){try{console.log("üöÄ ÂºÄÂßãËé∑Âèñ Cursor Áî®Êà∑ËßÑÂàô...");let e="";try{const{execSync:t}=r(2081),i=o.join(n.homedir(),"Library","Application Support","Cursor","User","globalStorage","state.vscdb");if(console.log("üìÅ Êï∞ÊçÆÂ∫ìË∑ØÂæÑ:",i),s.existsSync(i)){console.log("‚úÖ Êï∞ÊçÆÂ∫ìÊñá‰ª∂Â≠òÂú®"),console.log("üîç ÊâßË°å sqlite3 ÂëΩ‰ª§Êü•ËØ¢...");const r=t(`sqlite3 "${i}" "SELECT value FROM ItemTable WHERE key = 'aicontext.personalContext';"`,{encoding:"utf8",timeout:1e4});if(console.log("üìù sqlite3 ÂëΩ‰ª§ÊâßË°åÂÆåÊàê"),console.log("üìä Êü•ËØ¢ÁªìÊûúÈïøÂ∫¶:",r.length),r&&r.trim()){const t=r.trim();console.log("‚úÖ ‰ªéÊï∞ÊçÆÂ∫ìÊâæÂà∞Áî®Êà∑ËßÑÂàôÔºåÈïøÂ∫¶:",t.length),console.log("‚úÖ Áî®Êà∑ËßÑÂàôÂÜÖÂÆπÈ¢ÑËßà:",t.substring(0,200)+"..."),e=t}else console.log("‚ö†Ô∏è Êï∞ÊçÆÂ∫ìÊü•ËØ¢ËøîÂõûÁ©∫ÁªìÊûú")}else console.log("‚ùå Êï∞ÊçÆÂ∫ìÊñá‰ª∂‰∏çÂ≠òÂú®:",i)}catch(e){console.log("‚ùå Êï∞ÊçÆÂ∫ìÊü•ËØ¢Â§±Ë¥•:",e)}if(!e&&this.configPaths.settingsPath&&s.existsSync(this.configPaths.settingsPath)){console.log("üîç Â∞ùËØï‰ªé settings.json ÊêúÁ¥¢Áî®Êà∑ËßÑÂàô...");const t=s.readFileSync(this.configPaths.settingsPath,"utf-8"),r=JSON.parse(t),o=["cursor.rules.userRule","cursor.userRule","cursor.rules.user","cursor.chat.userRule","cursor.ai.userRule","cursor.composer.userRule","cursor.rules.global","cursor.globalRules","userRule","rules.user","rules.global","globalRules","cursor.rules","rules"];for(const t of o){const s=this.getNestedValue(r,t);if(s&&"string"==typeof s&&""!==s.trim()){e=s,console.log(`‚úÖ Âú®Â≠óÊÆµ '${t}' ‰∏≠ÊâæÂà∞Áî®Êà∑ËßÑÂàôÔºåÈïøÂ∫¶: ${s.length}`);break}}}return console.log("üéØ ÊúÄÁªàÁî®Êà∑ËßÑÂàôÁªìÊûú:",{found:!!e,length:e.length,preview:e.length>0?e.substring(0,100)+(e.length>100?"...":""):"Êó†ÂÜÖÂÆπ"}),{success:!0,userRule:e}}catch(e){return console.error("‚ùå Ëé∑Âèñ Cursor Áî®Êà∑ËßÑÂàôÂ§±Ë¥•:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}getNestedValue(e,t){return t.split(".").reduce(((e,t)=>e&&void 0!==e[t]?e[t]:void 0),e)}async getAllRulesInfo(){try{console.log("ÂºÄÂßãËé∑ÂèñÊâÄÊúâËßÑÂàô‰ø°ÊÅØ...");const[e,t,r]=await Promise.all([this.getUserRules(),this.getProjectCursorRules(),this.getCursorSettingsUserRule()]);return{success:!0,data:{cursorrules:e,projectRules:t.success?t.rules:[],cursorUserRule:r.success&&r.userRule||""}}}catch(e){return console.error("Ëé∑ÂèñÊâÄÊúâËßÑÂàô‰ø°ÊÅØÂ§±Ë¥•:",e),{success:!1,data:{cursorrules:"",projectRules:[],cursorUserRule:""},error:e instanceof Error?e.message:String(e)}}}async getCursorUserInfo(){try{let e;if(console.log("=== ÂºÄÂßãËé∑Âèñ Cursor Áî®Êà∑‰ø°ÊÅØ ==="),this.detectConfigPaths(),e="darwin"===this.platform?o.join(n.homedir(),"Library/Application Support/Cursor/User/globalStorage/state.vscdb"):"win32"===this.platform?o.join(n.homedir(),"AppData/Roaming/Cursor/User/globalStorage/state.vscdb"):o.join(n.homedir(),".config/Cursor/User/globalStorage/state.vscdb"),console.log("SQLite Êï∞ÊçÆÂ∫ìË∑ØÂæÑ:",e),!s.existsSync(e))return console.log("‚ùå Cursor SQLite Êï∞ÊçÆÂ∫ì‰∏çÂ≠òÂú®"),{isLoggedIn:!1};console.log("‚úÖ ÊâæÂà∞ Cursor SQLite Êï∞ÊçÆÂ∫ì");const{exec:t}=r(2081),{promisify:i}=r(3837),c=i(t);try{const t="\n          SELECT key, value \n          FROM ItemTable \n          WHERE key LIKE 'cursorAuth/%'\n        ",{stdout:r}=await c(`sqlite3 "${e}" "${t}"`,{encoding:"utf8"});console.log("Êï∞ÊçÆÂ∫ìÊü•ËØ¢ÁªìÊûú:",r);const s=r.trim().split("\n"),o={};for(const e of s)if(e.includes("|")){const[t,r]=e.split("|",2);t&&r&&(o[t]=r)}console.log("Ëß£ÊûêÁöÑËÆ§ËØÅÊï∞ÊçÆ:",o);const n=o["cursorAuth/cachedEmail"],i=o["cursorAuth/stripeMembershipType"],a=o["cursorAuth/accessToken"],l=o["cursorAuth/refreshToken"],u=!(!n||!a&&!l);return console.log("=== ÊúÄÁªàÊ£ÄÊµãÁªìÊûú ==="),console.log("ÈÇÆÁÆ±:",n||"Êú™ÊâæÂà∞"),console.log("‰ºöÂëòÁ±ªÂûã:",i||"Êú™ÊâæÂà∞"),console.log("ÁôªÂΩïÁä∂ÊÄÅ:",u),{isLoggedIn:u,email:n,username:n?n.split("@")[0]:void 0,cursorUserId:n,avatar:"",membershipType:i,token:a}}catch(e){return console.error("‚ùå Êï∞ÊçÆÂ∫ìÊü•ËØ¢Â§±Ë¥•:",e),console.log("=== Â∞ùËØïÂ§áÁî®ÊñπÊ≥ïÔºöËØªÂèñ settings.json ==="),await this.getCursorUserInfoFromSettings()}}catch(e){return console.error("‚ùå Ëé∑Âèñ Cursor Áî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:",e),{isLoggedIn:!1}}}async getCursorUserInfoFromSettings(){try{if(console.log("‰ΩøÁî®Â§áÁî®ÊñπÊ≥ï‰ªé settings.json ËØªÂèñÁî®Êà∑‰ø°ÊÅØ"),!this.configPaths.settingsPath||!s.existsSync(this.configPaths.settingsPath))return console.log("‚ùå Cursor ËÆæÁΩÆÊñá‰ª∂‰∏çÂ≠òÂú®"),{isLoggedIn:!1};console.log("‚úÖ ÊâæÂà∞ Cursor ËÆæÁΩÆÊñá‰ª∂");const e=s.readFileSync(this.configPaths.settingsPath,"utf-8");console.log("ËÆæÁΩÆÊñá‰ª∂ÂÜÖÂÆπÈïøÂ∫¶:",e.length);const t=JSON.parse(e),r=["cursor.account.email","account.email","cursor.pro.email","cursor.subscription.email","cursor.session.email","cursor.login.email","cursor.user.email","user.email","email","userEmail","loginEmail","accountEmail"],o=["cursor.account.name","account.name","cursor.pro.name","cursor.subscription.name","cursor.session.name","cursor.login.name","cursor.user.name","user.name","name","userName","loginName","accountName","displayName"];let n,i;for(const e of r)if(t[e]&&"string"==typeof t[e]){console.log(`‚úÖ Âú®Â≠óÊÆµ '${e}' ÊâæÂà∞ÈÇÆÁÆ±:`,t[e]),n=t[e];break}for(const e of o)if(t[e]&&"string"==typeof t[e]){console.log(`‚úÖ Âú®Â≠óÊÆµ '${e}' ÊâæÂà∞Áî®Êà∑Âêç:`,t[e]),i=t[e];break}if(!n){console.log("=== ÂºÄÂßãÊ∑±Â∫¶ÊêúÁ¥¢ÈÇÆÁÆ± ===");const e=(t,r="")=>{for(const[s,o]of Object.entries(t)){const t=r?`${r}.${s}`:s;if("string"==typeof o&&o.includes("@")&&o.includes("."))return console.log(`‚úÖ Ê∑±Â∫¶ÊêúÁ¥¢Âú® '${t}' ÊâæÂà∞ÂèØËÉΩÁöÑÈÇÆÁÆ±:`,o),o;if("object"==typeof o&&null!==o&&!Array.isArray(o)){const r=e(o,t);if(r)return r}}};n=e(t)}return console.log("=== Â§áÁî®ÊñπÊ≥ïÊ£ÄÊµãÁªìÊûú ==="),console.log("ÈÇÆÁÆ±:",n||"Êú™ÊâæÂà∞"),console.log("Áî®Êà∑Âêç:",i||"Êú™ÊâæÂà∞"),console.log("ÁôªÂΩïÁä∂ÊÄÅ:",!!n),{isLoggedIn:!!n,email:n,username:i,cursorUserId:n,avatar:"",membershipType:"",token:""}}catch(e){return console.error("‚ùå Â§áÁî®ÊñπÊ≥ïËé∑ÂèñÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:",e),{isLoggedIn:!1}}}async isCursorLoggedIn(){return(await this.getCursorUserInfo()).isLoggedIn}getSystemInfo(){return{platform:this.platform,version:process.version,isLoggedIn:!1,cursorPath:this.configPaths.customInstallPath||this.configPaths.cliPath||"Êú™ÊâæÂà∞",configPath:this.configPaths.settingsPath||"Êú™ÊâæÂà∞",mcpPath:this.configPaths.mcpPath||"Êú™ÊâæÂà∞",rulesPath:this.configPaths.rulesPath||"Êú™ÊâæÂà∞",cliPath:this.configPaths.cliPath||"Êú™ÊâæÂà∞"}}async getMcpConfigJson(){try{return{mcpConfig:await this.getMcpServers()}}catch(e){return console.error("Ëé∑Âèñ MCP ÈÖçÁΩÆ JSON Â§±Ë¥•:",e),{mcpConfig:{}}}}async batchUpdateMcpConfig(e){try{const t=this.configPaths.mcpPath;if(!t)throw new Error("Êú™ÊâæÂà∞ MCP ÈÖçÁΩÆÊñá‰ª∂Ë∑ØÂæÑ");let r={};if(s.existsSync(t)){const e=s.readFileSync(t,"utf8");r=JSON.parse(e)}const o={...r,mcpServers:e};s.writeFileSync(t,JSON.stringify(o,null,2),"utf8");const n=Object.keys(e).length;return console.log(`ÊàêÂäüÊâπÈáèÊõ¥Êñ∞ ${n} ‰∏™ MCP ÈÖçÁΩÆ`),{count:n}}catch(e){throw console.error("ÊâπÈáèÊõ¥Êñ∞ MCP ÈÖçÁΩÆÂ§±Ë¥•:",e),new Error("ÊâπÈáèÊõ¥Êñ∞ MCP ÈÖçÁΩÆÂ§±Ë¥•")}}async shareMcpConfig(e,t,r){throw new Error("Ê≠§ÊñπÊ≥ïÂ∫îËØ•ÈÄöËøáwebview‰ªªÂä°Â§ÑÁêÜÂô®Ë∞ÉÁî®")}async getMcpConfigByShareId(e){throw new Error("Ê≠§ÊñπÊ≥ïÂ∫îËØ•ÈÄöËøáwebview‰ªªÂä°Â§ÑÁêÜÂô®Ë∞ÉÁî®")}async addMcpByShareId(e){throw new Error("Ê≠§ÊñπÊ≥ïÂ∫îËØ•ÈÄöËøáwebview‰ªªÂä°Â§ÑÁêÜÂô®Ë∞ÉÁî®")}async updateUserRules(e){try{const t=this.findRulesPath();if(!t)return console.error("Rules path not found"),!1;const r=o.dirname(t);return s.existsSync(r)||s.mkdirSync(r,{recursive:!0}),s.writeFileSync(t,e,"utf8"),console.log("ËßÑÂàôÂ∑≤‰øùÂ≠òÂà∞:",t),!0}catch(e){return console.error("Error updating user rules:",e),!1}}}t.CursorIntegration=c,t.registerCursorIntegration=e=>{const{commands:t}=r(9496),{showWebView:s}=r(6677),o=new c;e.subscriptions.push(t.registerCommand("DiFlow.getCursorSettings",(async()=>{s(e,{key:"main",title:"Cursor ÁÆ°ÁêÜ",viewColumn:1,task:{task:"route",data:{path:"/cursor"}}})})),t.registerCommand("DiFlow.openCursorChat",(async e=>{try{let t=e;if(!t){const e=r(9496);if(t=await e.window.showInputBox({prompt:"ËØ∑ËæìÂÖ•Ë¶ÅÂèëÈÄÅÂà∞ Cursor Chat ÁöÑÊ∂àÊÅØ",placeHolder:"ËæìÂÖ•ÊÇ®ÁöÑÊ∂àÊÅØ..."}),!t)return void e.window.showInformationMessage("Â∑≤ÂèñÊ∂àÂèëÈÄÅÊ∂àÊÅØ")}console.log("ÂèëÈÄÅÊ∂àÊÅØÂà∞ Cursor Chat...",{message:t});const s=await o.openCursorChat(t);console.log("ÂèëÈÄÅÊ∂àÊÅØÂà∞ Cursor Chat ÁªìÊûú:",s),s?r(9496).window.showInformationMessage("Cursor Chat Êìç‰ΩúÂ∑≤ÂÆåÊàê"):r(9496).window.showWarningMessage("Êó†Ê≥ïÂÆåÊàê Cursor Chat Êìç‰ΩúÔºåËØ∑Á°Æ‰øùÂú® Cursor ÁéØÂ¢É‰∏≠ËøêË°å")}catch(e){r(9496).window.showErrorMessage(`Cursor Chat Êìç‰ΩúÂ§±Ë¥•: ${e instanceof Error?e.message:String(e)}`)}})))},t.registerCursorManagement=e=>{const{commands:t}=r(9496),{showWebView:s}=r(6677);e.subscriptions.push(t.registerCommand("DiFlow.cursorManagement",(async()=>{s(e,{key:"cursor",title:"Cursor ÁÆ°ÁêÜ",viewColumn:1,task:{task:"route",data:{path:"/cursor"}}})})))}},6677:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHtmlForWebview=t.showWebView=void 0;const s=r(9496),o=r(3912),n=r(6862),i=r(1017);r(7147);let c=[];const a=new n.CursorIntegration;t.showWebView=(e,r)=>{const o=c.find((e=>e.key===r.key));if(o)o.panel.reveal(),r.task&&o.panel.webview.postMessage({cmd:"vscodePushTask",task:r.task.task,data:r.task.data});else{const o=s.window.createWebviewPanel("DiFlow",r.title||"DiFlow",{viewColumn:r.viewColumn||s.ViewColumn.Two},{enableScripts:!0,retainContextWhenHidden:!0});o.iconPath=s.Uri.file(i.join(e.extensionPath,"images","title.jpg")),o.webview.html=(0,t.getHtmlForWebview)(e,o.webview);const n=[];o.webview.onDidReceiveMessage((async t=>{"webviewLoaded"===t.cmd&&r.task&&o.webview.postMessage({cmd:"vscodePushTask",task:r?.task?.task,data:r?.task?.data}),u[t.cmd]&&u[t.cmd](e,t)}),null,n),o.onDidDispose((()=>{for(o.dispose();n.length;){const e=n.pop();e&&e.dispose()}c=c.filter((e=>e.key!==r.key))}),null,n),c.push({key:r.key,panel:o,disposables:n}),r.task&&setTimeout((()=>{o.webview.postMessage({cmd:"vscodePushTask",task:r.task.task,data:r.task.data})}),500)}},t.getHtmlForWebview=(e,t)=>{const r=e.extensionMode===s.ExtensionMode.Production;let o="";if(console.log("isProduction",r),r){console.log("webview-dist/main.mjs");const r=s.Uri.file(i.join(e.extensionPath,"webview-dist","main.mjs"));o=t.asWebviewUri(r)}else console.log("localhost:7979/src/main.ts"),o="http://localhost:7979/src/main.ts";return l(o)};const l=e=>`<!doctype html>\n    <html lang="en">\n    <head>\n      <meta charset="UTF-8">\n      <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">\n      <meta http-equiv="Content-Security-Policy" content="default-src 'none'; script-src 'unsafe-inline' 'unsafe-eval' vscode-webview: http://localhost:* https://localhost:* http://127.0.0.1:* https://127.0.0.1:*; style-src 'unsafe-inline' vscode-webview: http://localhost:* https://localhost:* http://127.0.0.1:* https://127.0.0.1:*; connect-src vscode-webview: http://localhost:* https://localhost:* ws://localhost:* wss://localhost:* http://127.0.0.1:* https://127.0.0.1:* ws://127.0.0.1:* wss://127.0.0.1:*; img-src vscode-webview: data: http://localhost:* https://localhost:* http://127.0.0.1:* https://127.0.0.1:*; font-src vscode-webview: http://localhost:* https://localhost:* http://127.0.0.1:* https://127.0.0.1:*;">\n      <title>webview-react</title>\n      <script>\n         window.vscode = acquireVsCodeApi();\n         window.process = {\n           env: {\n             NODE_ENV: "production",\n           },\n         }\n         // Ê∑ªÂä†Ë∞ÉËØï‰ø°ÊÅØ\n         console.log("Webview CSP configured for localhost and 127.0.0.1");\n      <\/script>\n    </head>\n    <body>\n      <div id="app"></div>\n      <script  type="module" src="${e}"><\/script>\n    </body>\n    </html>`,u={updateUserRules:async(e,t)=>{try{console.log("Êõ¥Êñ∞Áî®Êà∑ËßÑÂàô...",t.data);const e=t.data,r=e?.rules;if("string"!=typeof r)throw new Error("ËßÑÂàôÂÜÖÂÆπÂøÖÈ°ªÊòØÂ≠óÁ¨¶‰∏≤Á±ªÂûã");const s=await a.updateUserRules(r);console.log("Êõ¥Êñ∞Áî®Êà∑ËßÑÂàôÁªìÊûú:",s);const o=c.filter((e=>"cursor"===e.key||"main"===e.key));o.length>0&&t.cbid&&o[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:s}})}catch(e){console.error("updateUserRules task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},getCursorSettings:async(e,t)=>{try{console.log("Ëé∑Âèñ Cursor ËÆæÁΩÆ...");const e=await a.getCursorSettings();console.log("Cursor ËÆæÁΩÆ:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:e}})}catch(e){console.error("getCursorSettings task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},updateCursorSettings:async(e,t)=>{try{console.log("Êõ¥Êñ∞ Cursor ËÆæÁΩÆ...",t.data);const e=await a.updateCursorSettings(t.data);console.log("Êõ¥Êñ∞ Cursor ËÆæÁΩÆÁªìÊûú:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:e}})}catch(e){console.error("updateCursorSettings task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e.message}})}},addSnippets:async(e,t)=>{try{const r=t.data;if(!r||"object"!=typeof r)throw new Error("Áº∫Â∞ëÂøÖË¶ÅÁöÑÊï∞ÊçÆ");const s=r;if(!(s.tips&&s.prefix&&s.body&&s.description))throw new Error("Áº∫Â∞ëÂøÖË¶ÅÁöÑ‰ª£Á†ÅÁâáÊÆµÂ≠óÊÆµ");await o.addSnippets(e,{data:s})}catch(e){console.error("addSnippets task failed:",e)}},openCursorChat:async(e,t)=>{try{console.log("ÊâìÂºÄ Cursor ËÅäÂ§©...",t.data);const e=t.data,r=await a.openCursorChat(e?.message||"");console.log("ÊâìÂºÄ Cursor ËÅäÂ§©ÁªìÊûú:",r);const s=c.filter((e=>"cursor"===e.key||"main"===e.key));s.length>0&&t.cbid&&s[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:r}})}catch(e){console.error("openCursorChat task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},sendToCursorChat:async(e,t)=>{try{console.log("ÂèëÈÄÅÊ∂àÊÅØÂà∞ Cursor Chat...",t.data);const e=t.data,r=await a.openCursorChat(e?.message||"");console.log("ÂèëÈÄÅÊ∂àÊÅØÂà∞ Cursor Chat ÁªìÊûú:",r);const s=c.filter((e=>"cursor"===e.key||"main"===e.key));s.length>0&&t.cbid&&s[0].panel.webview.postMessage({cbid:t.cbid,data:{success:r,data:r}})}catch(e){console.error("sendToCursorChat task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},getMcpServers:async(e,t)=>{try{console.log("Ëé∑Âèñ MCP ÊúçÂä°Âô®ÂàóË°®...");const e=await a.getMcpServers();console.log("MCP ÊúçÂä°Âô®ÂàóË°®:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:e}})}catch(e){console.error("getMcpServers task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},addMcpServer:async(e,t)=>{try{console.log("Ê∑ªÂä† MCP ÊúçÂä°Âô®...",t.data);const e=t.data,{name:r,config:s}=e;if(!r||!s)throw new Error("Áº∫Â∞ëÂøÖË¶ÅÂèÇÊï∞Ôºöname Êàñ config");const o=s;if(!o.command)throw new Error("MCP ÈÖçÁΩÆÁº∫Â∞ëÂøÖË¶ÅÁöÑ command Â≠óÊÆµ");const n=await a.addMcpServer(r,o);console.log("Ê∑ªÂä† MCP ÊúçÂä°Âô®ÁªìÊûú:",n);const i=c.filter((e=>"cursor"===e.key||"main"===e.key));i.length>0&&t.cbid&&i[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:n}})}catch(e){console.error("addMcpServer task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},removeMcpServer:async(e,t)=>{try{console.log("Âà†Èô§ MCP ÊúçÂä°Âô®...",t.data);const e=t.data,{name:r}=e;if(!r)throw new Error("Áº∫Â∞ëÂøÖË¶ÅÂèÇÊï∞Ôºöname");const s=await a.removeMcpServer(r);console.log("Âà†Èô§ MCP ÊúçÂä°Âô®ÁªìÊûú:",s);const o=c.filter((e=>"cursor"===e.key||"main"===e.key));o.length>0&&t.cbid&&o[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:s}})}catch(e){console.error("removeMcpServer task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},getUserRules:async(e,t)=>{try{console.log("Ëé∑ÂèñÁî®Êà∑ËßÑÂàô...");const e=await a.getUserRules();console.log("Áî®Êà∑ËßÑÂàô:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:e}})}catch(e){console.error("getUserRules task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},getSystemInfo:async(e,t)=>{try{console.log("Ëé∑ÂèñÁ≥ªÁªü‰ø°ÊÅØ...");const e=a.getSystemInfo();console.log("Á≥ªÁªü‰ø°ÊÅØ:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:e}})}catch(e){console.error("getSystemInfo task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e.message}})}},isCursorInstalled:async(e,t)=>{try{console.log("ÂºÄÂßãÊ£ÄÊµã Cursor ÂÆâË£ÖÁä∂ÊÄÅ...");const e=await a.isCursorInstalled();console.log("Cursor ÂÆâË£ÖÊ£ÄÊµãÁªìÊûú:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:e}})}catch(e){console.error("isCursorInstalled task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},openCursor:async(e,t)=>{try{console.log("ÊâìÂºÄ Cursor...",t.data);const e=t.data,r=e?.filePath,s=await a.openCursor(r);console.log("ÊâìÂºÄ Cursor ÁªìÊûú:",s);const o=c.filter((e=>"cursor"===e.key||"main"===e.key));o.length>0&&t.cbid&&o[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:s}})}catch(e){console.error("openCursor task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},setCustomInstallPath:async(e,t)=>{try{console.log("setCustomInstallPath Êî∂Âà∞Êï∞ÊçÆ:",t.data);const e=t.data,r=e?.path||e?.customPath;if(!r||"string"!=typeof r)throw new Error("Êú™Êèê‰æõÊúâÊïàÁöÑÂÆâË£ÖË∑ØÂæÑ");console.log("ËÆæÁΩÆËá™ÂÆö‰πâÂÆâË£ÖË∑ØÂæÑ:",r),a.setCustomInstallPath(r);const s=await a.isCursorInstalled(),o=a.getSystemInfo();console.log("ÈáçÊñ∞Ê£ÄÊµãÁªìÊûú:",{isInstalled:s,systemInfo:o});const n=c.filter((e=>"cursor"===e.key||"main"===e.key));n.length>0&&t.cbid&&n[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,isInstalled:s,systemInfo:o}})}catch(e){console.error("setCustomInstallPath task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},getCursorUserInfo:async(e,t)=>{try{console.log("Ëé∑Âèñ Cursor Áî®Êà∑‰ø°ÊÅØ...");const e=await a.getCursorUserInfo();console.log("Cursor Áî®Êà∑‰ø°ÊÅØ:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:e}})}catch(e){console.error("getCursorUserInfo task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},isCursorLoggedIn:async(e,t)=>{try{console.log("Ê£ÄÊü• Cursor ÁôªÂΩïÁä∂ÊÄÅ...");const e=await a.isCursorLoggedIn();console.log("Cursor ÁôªÂΩïÁä∂ÊÄÅ:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:e}})}catch(e){console.error("isCursorLoggedIn task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},loginOrCreateUser:async(e,t)=>{try{console.log("Ëé∑ÂèñCursorÁî®Êà∑‰ø°ÊÅØ...",t.data);const e=await a.getCursorUserInfo();console.log("CursorÁî®Êà∑‰ø°ÊÅØ:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:e}})}catch(e){console.error("loginOrCreateUser task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e.message}})}},syncUserData:async(e,t)=>{try{console.log("ÂêåÊ≠•Áî®Êà∑Êï∞ÊçÆ‰ªªÂä° - Áî±webviewÂ§ÑÁêÜ",t.data);const e=c.filter((e=>"cursor"===e.key||"main"===e.key));e.length>0&&t.cbid&&e[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,message:"‰ªªÂä°Â∑≤ËΩ¨ÂèëÂà∞webviewÂ§ÑÁêÜ"}})}catch(e){console.error("syncUserData task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},syncRulesToServer:async(e,t)=>{try{console.log("ÂêåÊ≠•ËßÑÂàôÂà∞ÊúçÂä°Âô®‰ªªÂä° - Áî±webviewÂ§ÑÁêÜ",t.data);const e=c.filter((e=>"cursor"===e.key||"main"===e.key));e.length>0&&t.cbid&&e[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,message:"‰ªªÂä°Â∑≤ËΩ¨ÂèëÂà∞webviewÂ§ÑÁêÜ"}})}catch(e){console.error("syncRulesToServer task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},syncMcpsToServer:async(e,t)=>{try{console.log("ÂêåÊ≠•MCPÈÖçÁΩÆÂà∞ÊúçÂä°Âô®‰ªªÂä° - Áî±webviewÂ§ÑÁêÜ",t.data);const e=c.filter((e=>"cursor"===e.key||"main"===e.key));e.length>0&&t.cbid&&e[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,message:"‰ªªÂä°Â∑≤ËΩ¨ÂèëÂà∞webviewÂ§ÑÁêÜ"}})}catch(e){console.error("syncMcpsToServer task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},networkRequest:async(e,t)=>{try{const e=t.data;if(!e||"object"!=typeof e)throw new Error("ËØ∑Ê±ÇÊï∞ÊçÆÊó†Êïà");const{url:s,method:o="GET",headers:n={},body:i}=e;if(!s||"string"!=typeof s)throw new Error("URL ÂèÇÊï∞Êó†Êïà");console.log(`ÁΩëÁªúËØ∑Ê±Ç: ${o} ${s}`);const a=r(5687),l=r(3685),{URL:u}=r(7310),d=new u(s),f="https:"===d.protocol,h=f?a:l,g={hostname:d.hostname,port:d.port||(f?443:80),path:d.pathname+d.search,method:o,headers:{"User-Agent":"DIFlow-VSCode-Extension/1.0.0",..."object"==typeof n&&null!==n?n:{}}},p=await new Promise(((e,t)=>{const r=h.request(g,(r=>{let s="";r.on("data",(e=>{s+=e})),r.on("end",(()=>{try{let t;try{t=JSON.parse(s)}catch{t=s}e({ok:r.statusCode>=200&&r.statusCode<300,status:r.statusCode,statusText:r.statusMessage,data:t,text:s,headers:r.headers})}catch(e){t(e)}}))}));r.on("error",(e=>{t(e)})),!i||"POST"!==o&&"PUT"!==o&&"PATCH"!==o||r.write("string"==typeof i?i:JSON.stringify(i)),r.end()}));console.log(`ÁΩëÁªúËØ∑Ê±ÇÂÆåÊàê: ${o} ${s} - ${p.status}`);const y=c.filter((e=>"cursor"===e.key||"main"===e.key));y.length>0&&t.cbid&&y[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:p}})}catch(e){console.error("ÁΩëÁªúËØ∑Ê±ÇÂ§±Ë¥•:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},proxyRequest:async(e,t)=>{try{console.log("‰ª£ÁêÜÁΩëÁªúËØ∑Ê±Ç:",t.data);const e=t.data;if(!e||"object"!=typeof e)throw new Error("ËØ∑Ê±ÇÊï∞ÊçÆÊó†Êïà");const{method:s,url:o,data:n,headers:i}=e;if(!s||!o)throw new Error("ÊñπÊ≥ïÊàñURLÂèÇÊï∞Áº∫Â§±");const a=r(5687),l=r(3685),u=r(7310).parse(o),d="https:"===u.protocol,f=d?a:l,h={hostname:u.hostname,port:u.port||(d?443:80),path:u.path,method:String(s).toUpperCase(),headers:{"Content-Type":"application/json","User-Agent":"DIFlow-VSCode-Extension/1.0.0",...i||{}},rejectUnauthorized:!1};console.log("‰ª£ÁêÜËØ∑Ê±ÇÈÄâÈ°π:",h);const g=await new Promise(((e,t)=>{const r=f.request(h,(t=>{let r="";t.on("data",(e=>{r+=e})),t.on("end",(()=>{try{console.log("ÂéüÂßãÂìçÂ∫îÊï∞ÊçÆ:",r);const s=r?JSON.parse(r):{};e({success:!0,status:t.statusCode,data:s,headers:t.headers})}catch(s){console.log("JSONËß£ÊûêÂ§±Ë¥•ÔºåËøîÂõûÂéüÂßãÊï∞ÊçÆ:",s),e({success:!0,status:t.statusCode,data:r,headers:t.headers})}}))}));if(r.on("error",(e=>{console.error("‰ª£ÁêÜËØ∑Ê±ÇÈîôËØØ:",e),t({success:!1,message:`ÁΩëÁªúËØ∑Ê±ÇÂ§±Ë¥•: ${e.message}`,error:e})})),r.setTimeout(1e4,(()=>{r.destroy(),t({success:!1,message:"ËØ∑Ê±ÇË∂ÖÊó∂",error:new Error("Request timeout")})})),n&&("POST"===String(s).toUpperCase()||"PUT"===String(s).toUpperCase())){const e=JSON.stringify(n);console.log("ÂèëÈÄÅËØ∑Ê±Ç‰ΩìÊï∞ÊçÆ:",e),r.write(e)}r.end()}));console.log("‰ª£ÁêÜËØ∑Ê±ÇÊàêÂäü:",g);const p=c.filter((e=>"cursor"===e.key||"main"===e.key));p.length>0&&t.cbid&&p[0].panel.webview.postMessage({cbid:t.cbid,data:g})}catch(e){console.error("proxyRequest task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,message:e instanceof Error?e.message:"ÁΩëÁªúËØ∑Ê±ÇÂ§±Ë¥•",error:e}})}},"cursor:getMcpConfigJson":async(e,t)=>{try{console.log("=== ÂºÄÂßãËé∑Âèñ MCP ÈÖçÁΩÆ JSON ==="),console.log("Ê∂àÊÅØÊï∞ÊçÆ:",t),console.log("Ë∞ÉÁî® cursorIntegration.getMcpConfigJson()...");const e=await a.getMcpConfigJson();console.log("Ëé∑Âèñ MCP ÈÖçÁΩÆ JSON ÁªìÊûú:",e),console.log("ÈÖçÁΩÆÈ°πÊï∞Èáè:",Object.keys(e.mcpConfig||{}).length);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));console.log("ÊâæÂà∞ÁöÑ webview panels:",r.length),r.length>0&&t.cbid?(console.log("ÂèëÈÄÅÊàêÂäüÂìçÂ∫îÂà∞ webview, cbid:",t.cbid),r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:e}}),console.log("‚úÖ ÊàêÂäüÂèëÈÄÅÂìçÂ∫îÂà∞ webview")):(console.error("‚ùå Ê≤°ÊúâÊâæÂà∞ÂØπÂ∫îÁöÑ webview panel ÊàñÁº∫Â∞ë cbid"),console.log("panels.length:",r.length),console.log("message.cbid:",t.cbid))}catch(e){console.error("‚ùå getMcpConfigJson task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&(console.log("ÂèëÈÄÅÈîôËØØÂìçÂ∫îÂà∞ webview, cbid:",t.cbid),r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}}))}},"cursor:batchUpdateMcpConfig":async(e,t)=>{try{console.log("ÊâπÈáèÊõ¥Êñ∞ MCP ÈÖçÁΩÆ...",t.data);const e=t.data,r=await a.batchUpdateMcpConfig(e.mcpConfig);console.log("ÊâπÈáèÊõ¥Êñ∞ MCP ÈÖçÁΩÆÁªìÊûú:",r);const s=c.filter((e=>"cursor"===e.key||"main"===e.key));s.length>0&&t.cbid&&s[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!0,data:r}})}catch(e){console.error("batchUpdateMcpConfig task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},"cursor:shareMcpConfig":async(e,t)=>{try{console.log("ÂàÜ‰∫´ MCP ÈÖçÁΩÆ...",t.data);const e=c.filter((e=>"cursor"===e.key||"main"===e.key));e.length>0&&t.cbid&&e[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:"Ê≠§ÂäüËÉΩÈúÄË¶ÅÈÄöËøáÂâçÁ´ØhttpUtilsË∞ÉÁî®ÂêéÁ´ØAPI"}})}catch(e){console.error("shareMcpConfig task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},"cursor:getMcpConfigByShareId":async(e,t)=>{try{console.log("Ëé∑ÂèñÂàÜ‰∫´ÈÖçÁΩÆ...",t.data);const e=c.filter((e=>"cursor"===e.key||"main"===e.key));e.length>0&&t.cbid&&e[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:"Ê≠§ÂäüËÉΩÈúÄË¶ÅÈÄöËøáÂâçÁ´ØhttpUtilsË∞ÉÁî®ÂêéÁ´ØAPI"}})}catch(e){console.error("getMcpConfigByShareId task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},"cursor:addMcpByShareId":async(e,t)=>{try{console.log("ÈÄöËøáÂàÜ‰∫´ ID Ê∑ªÂä†ÈÖçÁΩÆ...",t.data);const e=c.filter((e=>"cursor"===e.key||"main"===e.key));e.length>0&&t.cbid&&e[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:"Ê≠§ÂäüËÉΩÈúÄË¶ÅÈÄöËøáÂâçÁ´ØhttpUtilsË∞ÉÁî®ÂêéÁ´ØAPI"}})}catch(e){console.error("addMcpByShareId task failed:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},getProjectCursorRules:async(e,t)=>{try{console.log("Â§ÑÁêÜ getProjectCursorRules ‰ªªÂä°...");const e=new n.CursorIntegration,r=await e.getProjectCursorRules();console.log("getProjectCursorRules ÁªìÊûú:",r);const s=c.filter((e=>"cursor"===e.key||"main"===e.key));s.length>0&&t.cbid&&s[0].panel.webview.postMessage({cbid:t.cbid,data:{success:r.success,data:{rules:r.rules||[]},error:r.error}})}catch(e){console.error("getProjectCursorRules ‰ªªÂä°Â§±Ë¥•:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},getCursorSettingsUserRule:async(e,t)=>{try{console.log("Â§ÑÁêÜ getCursorSettingsUserRule ‰ªªÂä°...");const e=new n.CursorIntegration,r=await e.getCursorSettingsUserRule();console.log("getCursorSettingsUserRule ÁªìÊûú:",r);const s=c.filter((e=>"cursor"===e.key||"main"===e.key));s.length>0&&t.cbid&&s[0].panel.webview.postMessage({cbid:t.cbid,data:{success:r.success,data:{userRule:r.userRule||""},error:r.error}})}catch(e){console.error("getCursorSettingsUserRule ‰ªªÂä°Â§±Ë¥•:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}},getAllRulesInfo:async(e,t)=>{try{console.log("Â§ÑÁêÜ getAllRulesInfo ‰ªªÂä°...");const e=new n.CursorIntegration,r=await e.getAllRulesInfo();console.log("getAllRulesInfo ÁªìÊûú:",r);const s=c.filter((e=>"cursor"===e.key||"main"===e.key));s.length>0&&t.cbid&&s[0].panel.webview.postMessage({cbid:t.cbid,data:{success:r.success,data:r.data,error:r.error}})}catch(e){console.error("getAllRulesInfo ‰ªªÂä°Â§±Ë¥•:",e);const r=c.filter((e=>"cursor"===e.key||"main"===e.key));r.length>0&&t.cbid&&r[0].panel.webview.postMessage({cbid:t.cbid,data:{success:!1,error:e instanceof Error?e.message:String(e)}})}}}},3912:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSnippets=void 0;const s=r(9496),o=r(1017);t.addSnippets=(e,t)=>{const r=s.workspace.rootPath,n=o.join(r,".vscode/test.code-snippets"),i=s.Uri.file(n),c={[t.data.tips]:{prefix:t.data?.prefix,body:[t.data?.body],description:t.data?.description}};(async()=>{try{let e={};try{(await s.workspace.fs.stat(i)).type!==s.FileType.File&&await s.workspace.fs.writeFile(i,Buffer.from("","utf8"))}catch(e){await s.workspace.fs.writeFile(i,Buffer.from("","utf8"))}const r=await s.workspace.fs.readFile(i);r&&r.toString()&&(e=JSON.parse(r.toString())),e=e[c[t.data.tips].prefix]?c:{...e,...c};const o=JSON.stringify(e,null,2);await s.workspace.fs.writeFile(i,Buffer.from(o,"utf-8")),s.window.showInformationMessage("‰ª£Á†ÅÁâáÊÆµÊ∑ªÂä†ÊàêÂäü!")}catch(e){s.window.showErrorMessage(`‰ª£Á†ÅÁâáÊÆµÊ∑ªÂä†Â§±Ë¥•: ${e}`)}})()}},8981:(e,t)=>{"use strict";t.fromCallback=function(e){return Object.defineProperty((function(...t){if("function"!=typeof t[t.length-1])return new Promise(((r,s)=>{t.push(((e,t)=>null!=e?s(e):r(t))),e.apply(this,t)}));e.apply(this,t)}),"name",{value:e.name})},t.fromPromise=function(e){return Object.defineProperty((function(...t){const r=t[t.length-1];if("function"!=typeof r)return e.apply(this,t);t.pop(),e.apply(this,t).then((e=>r(null,e)),r)}),"name",{value:e.name})}},9496:e=>{"use strict";e.exports=require("vscode")},9491:e=>{"use strict";e.exports=require("assert")},2081:e=>{"use strict";e.exports=require("child_process")},2057:e=>{"use strict";e.exports=require("constants")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")}},t={};function r(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,r),n.exports}var s={};(()=>{"use strict";var e=s;Object.defineProperty(e,"__esModule",{value:!0}),e.deactivate=e.activate=void 0;const t=r(7413),o=r(7093),n=r(4116),i=r(7363),c=r(6862);e.activate=function(e){(0,t.registerCreateScript)(e),(0,o.registerCreateSnippets)(e),(0,n.registerCreateSetting)(e),(0,i.registerCreateChatGPTView)(e),(0,c.registerCursorIntegration)(e),(0,c.registerCursorManagement)(e)},e.deactivate=function(){}})(),module.exports=s})();
//# sourceMappingURL=extension.js.map